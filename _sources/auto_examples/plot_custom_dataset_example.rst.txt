.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_plot_custom_dataset_example.py>`     to download the full example code
    .. rst-class:: sphx-glr-example-title

    .. _sphx_glr_auto_examples_plot_custom_dataset_example.py:

Custom Dataset Example
=========================

This example shows how to convert data from X and y to a braindecode
compatible data format.


.. code-block:: default


    # Authors: Lukas Gemein <l.gemein@gmail.com>
    #
    # License: BSD (3-clause)

    import mne

    from braindecode.datasets.xy import create_from_X_y








To set up the example, we first fetch some data using mne:


.. code-block:: default


    # 5, 6, 7, 10, 13, 14 are codes for executed and imagined hands/feet
    subject_id = 22
    event_codes = [5, 6, 9, 10, 13, 14]
    # event_codes = [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]

    # This will download the files if you don't have them yet,
    # and then return the paths to the files.
    physionet_paths = mne.datasets.eegbci.load_data(
        subject_id, event_codes, update_path=False)

    # Load each of the files
    parts = [mne.io.read_raw_edf(path, preload=True, stim_channel='auto')
             for path in physionet_paths]





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Using default location ~/mne_data for EEGBCI...
    Downloading https://physionet.org/files/eegmmidb/1.0.0/S022/S022R05.edf (2.5 MB)
      0%|          | Downloading : 0.00/2.48M [00:00<?,        ?B/s]      2%|2         | Downloading : 56.0k/2.48M [00:00<00:01,    1.80MB/s]      6%|5         | Downloading : 152k/2.48M [00:00<00:01,    1.85MB/s]      14%|#3        | Downloading : 344k/2.48M [00:00<00:01,    1.92MB/s]     19%|#8        | Downloading : 472k/2.48M [00:00<00:01,    1.97MB/s]     24%|##3       | Downloading : 600k/2.48M [00:00<00:00,    2.03MB/s]     29%|##8       | Downloading : 728k/2.48M [00:00<00:00,    2.11MB/s]     39%|###8      | Downloading : 984k/2.48M [00:00<00:00,    2.19MB/s]     49%|####8     | Downloading : 1.21M/2.48M [00:00<00:00,    2.28MB/s]     59%|#####8    | Downloading : 1.46M/2.48M [00:00<00:00,    2.37MB/s]     74%|#######4  | Downloading : 1.84M/2.48M [00:00<00:00,    2.47MB/s]     84%|########4 | Downloading : 2.09M/2.48M [00:00<00:00,    2.57MB/s]     94%|#########4| Downloading : 2.34M/2.48M [00:00<00:00,    2.67MB/s]    100%|##########| Downloading : 2.48M/2.48M [00:00<00:00,    7.59MB/s]
    Using default location ~/mne_data for EEGBCI...
    Downloading https://physionet.org/files/eegmmidb/1.0.0/S022/S022R06.edf (2.5 MB)
      0%|          | Downloading : 0.00/2.48M [00:00<?,        ?B/s]      3%|3         | Downloading : 88.0k/2.48M [00:00<00:01,    1.75MB/s]      7%|7         | Downloading : 184k/2.48M [00:00<00:01,    1.82MB/s]      10%|9         | Downloading : 248k/2.48M [00:00<00:01,    1.64MB/s]     16%|#6        | Downloading : 408k/2.48M [00:00<00:01,    1.70MB/s]     26%|##6       | Downloading : 664k/2.48M [00:00<00:01,    1.78MB/s]     31%|###1      | Downloading : 792k/2.48M [00:00<00:00,    1.85MB/s]     36%|###6      | Downloading : 920k/2.48M [00:00<00:00,    1.92MB/s]     51%|#####1    | Downloading : 1.27M/2.48M [00:00<00:00,    2.01MB/s]     62%|######1   | Downloading : 1.52M/2.48M [00:00<00:00,    2.10MB/s]     82%|########1 | Downloading : 2.02M/2.48M [00:00<00:00,    2.20MB/s]    100%|##########| Downloading : 2.48M/2.48M [00:00<00:00,    2.30MB/s]    100%|##########| Downloading : 2.48M/2.48M [00:00<00:00,    7.25MB/s]
    Using default location ~/mne_data for EEGBCI...
    Downloading https://physionet.org/files/eegmmidb/1.0.0/S022/S022R09.edf (2.5 MB)
      0%|          | Downloading : 0.00/2.48M [00:00<?,        ?B/s]      2%|1         | Downloading : 40.0k/2.48M [00:00<00:01,    1.69MB/s]      3%|3         | Downloading : 88.0k/2.48M [00:00<00:01,    1.73MB/s]      6%|5         | Downloading : 152k/2.48M [00:00<00:01,    1.77MB/s]      14%|#3        | Downloading : 344k/2.48M [00:00<00:01,    1.85MB/s]     29%|##8       | Downloading : 728k/2.48M [00:00<00:00,    1.94MB/s]     59%|#####8    | Downloading : 1.46M/2.48M [00:00<00:00,    2.03MB/s]     79%|#######9  | Downloading : 1.96M/2.48M [00:00<00:00,    2.12MB/s]     99%|#########9| Downloading : 2.46M/2.48M [00:00<00:00,    2.23MB/s]    100%|##########| Downloading : 2.48M/2.48M [00:00<00:00,    14.1MB/s]
    Using default location ~/mne_data for EEGBCI...
    Downloading https://physionet.org/files/eegmmidb/1.0.0/S022/S022R10.edf (2.5 MB)
      0%|          | Downloading : 0.00/2.48M [00:00<?,        ?B/s]      1%|          | Downloading : 24.0k/2.48M [00:00<00:02,    1.17MB/s]      3%|2         | Downloading : 72.0k/2.48M [00:00<00:02,    1.20MB/s]      7%|6         | Downloading : 168k/2.48M [00:00<00:01,    1.25MB/s]      14%|#4        | Downloading : 360k/2.48M [00:00<00:01,    1.30MB/s]     19%|#9        | Downloading : 488k/2.48M [00:00<00:01,    1.36MB/s]     29%|##9       | Downloading : 744k/2.48M [00:00<00:01,    1.42MB/s]     39%|###9      | Downloading : 0.98M/2.48M [00:00<00:01,    1.48MB/s]     50%|####9     | Downloading : 1.23M/2.48M [00:00<00:00,    1.55MB/s]     55%|#####4    | Downloading : 1.35M/2.48M [00:00<00:00,    1.59MB/s]     70%|######9   | Downloading : 1.73M/2.48M [00:00<00:00,    1.66MB/s]     80%|#######9  | Downloading : 1.98M/2.48M [00:00<00:00,    1.74MB/s]     90%|########9 | Downloading : 2.23M/2.48M [00:00<00:00,    1.82MB/s]    100%|#########9| Downloading : 2.48M/2.48M [00:00<00:00,    1.90MB/s]    100%|##########| Downloading : 2.48M/2.48M [00:00<00:00,    8.46MB/s]
    Using default location ~/mne_data for EEGBCI...
    Downloading https://physionet.org/files/eegmmidb/1.0.0/S022/S022R13.edf (2.5 MB)
      0%|          | Downloading : 0.00/2.48M [00:00<?,        ?B/s]      2%|2         | Downloading : 56.0k/2.48M [00:00<00:00,    3.08MB/s]      5%|4         | Downloading : 120k/2.48M [00:00<00:00,    3.11MB/s]      12%|#2        | Downloading : 312k/2.48M [00:00<00:00,    3.22MB/s]     17%|#7        | Downloading : 440k/2.48M [00:00<00:00,    3.32MB/s]     32%|###2      | Downloading : 824k/2.48M [00:00<00:00,    3.43MB/s]     43%|####2     | Downloading : 1.05M/2.48M [00:00<00:00,    3.56MB/s]     53%|#####2    | Downloading : 1.30M/2.48M [00:00<00:00,    3.69MB/s]     63%|######2   | Downloading : 1.55M/2.48M [00:00<00:00,    3.82MB/s]     73%|#######2  | Downloading : 1.80M/2.48M [00:00<00:00,    3.95MB/s]     83%|########2 | Downloading : 2.05M/2.48M [00:00<00:00,    4.10MB/s]     93%|#########3| Downloading : 2.30M/2.48M [00:00<00:00,    4.24MB/s]    100%|##########| Downloading : 2.48M/2.48M [00:00<00:00,    4.37MB/s]    100%|##########| Downloading : 2.48M/2.48M [00:00<00:00,    9.96MB/s]
    Using default location ~/mne_data for EEGBCI...
    Downloading https://physionet.org/files/eegmmidb/1.0.0/S022/S022R14.edf (2.5 MB)
      0%|          | Downloading : 0.00/2.48M [00:00<?,        ?B/s]      3%|3         | Downloading : 88.0k/2.48M [00:00<00:00,    4.32MB/s]      9%|8         | Downloading : 216k/2.48M [00:00<00:00,    4.37MB/s]      21%|##1       | Downloading : 536k/2.48M [00:00<00:00,    4.50MB/s]     26%|##6       | Downloading : 664k/2.48M [00:00<00:00,    4.59MB/s]     36%|###6      | Downloading : 920k/2.48M [00:00<00:00,    4.73MB/s]     51%|#####1    | Downloading : 1.27M/2.48M [00:00<00:00,    4.89MB/s]     72%|#######1  | Downloading : 1.77M/2.48M [00:00<00:00,    5.04MB/s]     82%|########1 | Downloading : 2.02M/2.48M [00:00<00:00,    5.10MB/s]     92%|#########1| Downloading : 2.27M/2.48M [00:00<00:00,    5.26MB/s]    100%|##########| Downloading : 2.48M/2.48M [00:00<00:00,    5.40MB/s]    100%|##########| Downloading : 2.48M/2.48M [00:00<00:00,    9.62MB/s]
    Extracting EDF parameters from /home/circleci/mne_data/MNE-eegbci-data/files/eegmmidb/1.0.0/S022/S022R05.edf...
    EDF file detected
    Setting channel info structure...
    Creating raw.info structure...
    Reading 0 ... 19999  =      0.000 ...   124.994 secs...
    Extracting EDF parameters from /home/circleci/mne_data/MNE-eegbci-data/files/eegmmidb/1.0.0/S022/S022R06.edf...
    EDF file detected
    Setting channel info structure...
    Creating raw.info structure...
    Reading 0 ... 19999  =      0.000 ...   124.994 secs...
    Extracting EDF parameters from /home/circleci/mne_data/MNE-eegbci-data/files/eegmmidb/1.0.0/S022/S022R09.edf...
    EDF file detected
    Setting channel info structure...
    Creating raw.info structure...
    Reading 0 ... 19999  =      0.000 ...   124.994 secs...
    Extracting EDF parameters from /home/circleci/mne_data/MNE-eegbci-data/files/eegmmidb/1.0.0/S022/S022R10.edf...
    EDF file detected
    Setting channel info structure...
    Creating raw.info structure...
    Reading 0 ... 19999  =      0.000 ...   124.994 secs...
    Extracting EDF parameters from /home/circleci/mne_data/MNE-eegbci-data/files/eegmmidb/1.0.0/S022/S022R13.edf...
    EDF file detected
    Setting channel info structure...
    Creating raw.info structure...
    Reading 0 ... 19999  =      0.000 ...   124.994 secs...
    Extracting EDF parameters from /home/circleci/mne_data/MNE-eegbci-data/files/eegmmidb/1.0.0/S022/S022R14.edf...
    EDF file detected
    Setting channel info structure...
    Creating raw.info structure...
    Reading 0 ... 19999  =      0.000 ...   124.994 secs...




We take the required data, targets and additional information sampling
frequency and channel names from the loaded data. Note that this data and
information can originate from any source.


.. code-block:: default

    X = [raw.get_data() for raw in parts]
    y = event_codes
    sfreq = parts[0].info["sfreq"]
    ch_names = parts[0].info["ch_names"]








Convert to data format compatible with skorch and braindecode:


.. code-block:: default

    windows_dataset = create_from_X_y(
        X, y, sfreq, ch_names,
        supercrop_stride_samples=500,
        supercrop_size_samples=500,
        drop_samples=False
    )




.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Creating RawArray with float64 data, n_channels=64, n_times=20000
        Range : 0 ... 19999 =      0.000 ...   124.994 secs
    Ready.
    Creating RawArray with float64 data, n_channels=64, n_times=20000
        Range : 0 ... 19999 =      0.000 ...   124.994 secs
    Ready.
    Creating RawArray with float64 data, n_channels=64, n_times=20000
        Range : 0 ... 19999 =      0.000 ...   124.994 secs
    Ready.
    Creating RawArray with float64 data, n_channels=64, n_times=20000
        Range : 0 ... 19999 =      0.000 ...   124.994 secs
    Ready.
    Creating RawArray with float64 data, n_channels=64, n_times=20000
        Range : 0 ... 19999 =      0.000 ...   124.994 secs
    Ready.
    Creating RawArray with float64 data, n_channels=64, n_times=20000
        Range : 0 ... 19999 =      0.000 ...   124.994 secs
    Ready.
    40 matching events found
    No baseline correction applied
    Adding metadata with 4 columns
    0 projection items activated
    Loading data for 40 events and 500 original time points ...
    0 bad epochs dropped
    40 matching events found
    No baseline correction applied
    Adding metadata with 4 columns
    0 projection items activated
    Loading data for 40 events and 500 original time points ...
    0 bad epochs dropped
    40 matching events found
    No baseline correction applied
    Adding metadata with 4 columns
    0 projection items activated
    Loading data for 40 events and 500 original time points ...
    0 bad epochs dropped
    40 matching events found
    No baseline correction applied
    Adding metadata with 4 columns
    0 projection items activated
    Loading data for 40 events and 500 original time points ...
    0 bad epochs dropped
    40 matching events found
    No baseline correction applied
    Adding metadata with 4 columns
    0 projection items activated
    Loading data for 40 events and 500 original time points ...
    0 bad epochs dropped
    40 matching events found
    No baseline correction applied
    Adding metadata with 4 columns
    0 projection items activated
    Loading data for 40 events and 500 original time points ...
    0 bad epochs dropped





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  4.337 seconds)

**Estimated memory usage:**  131 MB


.. _sphx_glr_download_auto_examples_plot_custom_dataset_example.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_custom_dataset_example.py <plot_custom_dataset_example.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_custom_dataset_example.ipynb <plot_custom_dataset_example.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
