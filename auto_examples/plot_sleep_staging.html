

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Sleep staging on the Sleep Physionet dataset &mdash; Braindecode 0.5 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-dataframe.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-rendered-html.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Benchmarking eager and lazy loading" href="benchmark_lazy_eager_loading.html" />
    <link rel="prev" title="Regression example on fake data" href="plot_regression.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> Braindecode
          

          
          </a>

          
            
            
              <div class="version">
                0.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="plot_bcic_iv_2a_moabb_trial.html"> Basic trialwise decoding</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot_bcic_iv_2a_moabb_cropped.html"> More data-efficient &quot;cropped decoding&quot;</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot_mne_dataset_example.html"> Your own datasets through MNE</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot_custom_dataset_example.html"> Your own datasets through Numpy</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Braindecode examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="plot_split_dataset.html">Split Dataset Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_custom_dataset_example.html">Custom Dataset Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_mne_dataset_example.html">MNE Dataset Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_dataset_example.html">MOABB Dataset Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_regression.html">Regression example on fake data</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Sleep staging on the Sleep Physionet dataset</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#references">References</a></li>
<li class="toctree-l3"><a class="reference internal" href="#loading-and-preprocessing-the-dataset">Loading and preprocessing the dataset</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#loading">Loading</a></li>
<li class="toctree-l4"><a class="reference internal" href="#preprocessing">Preprocessing</a></li>
<li class="toctree-l4"><a class="reference internal" href="#extract-windows">Extract windows</a></li>
<li class="toctree-l4"><a class="reference internal" href="#window-preprocessing">Window preprocessing</a></li>
<li class="toctree-l4"><a class="reference internal" href="#split-dataset-into-train-and-valid">Split dataset into train and valid</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#create-model">Create model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#training">Training</a></li>
<li class="toctree-l3"><a class="reference internal" href="#plot-results">Plot results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plot_bcic_iv_2a_moabb_trial.html">Trialwise Decoding on BCIC IV 2a Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_bcic_iv_2a_moabb_cropped.html">Cropped Decoding on BCIC IV 2a Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="benchmark_lazy_eager_loading.html">Benchmarking eager and lazy loading</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_relative_positioning.html">Self-supervised learning on EEG with relative positioning</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Reference</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Braindecode</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Braindecode examples</a> &raquo;</li>
        
      <li>Sleep staging on the Sleep Physionet dataset</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/auto_examples/plot_sleep_staging.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-plot-sleep-staging-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="sleep-staging-on-the-sleep-physionet-dataset">
<span id="sphx-glr-auto-examples-plot-sleep-staging-py"></span><h1>Sleep staging on the Sleep Physionet dataset<a class="headerlink" href="#sleep-staging-on-the-sleep-physionet-dataset" title="Permalink to this headline">¶</a></h1>
<p>This tutorial shows how to train and test a sleep staging neural network with
Braindecode. We follow the approach of <a class="footnote-reference brackets" href="#id4" id="id1">1</a> on the openly accessible Sleep
Physionet dataset <a class="footnote-reference brackets" href="#id4" id="id2">1</a> <a class="footnote-reference brackets" href="#id5" id="id3">2</a>.</p>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<dl class="footnote brackets">
<dt class="label" id="id4"><span class="brackets">1</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id2">2</a>,<a href="#id7">3</a>,<a href="#id8">4</a>,<a href="#id9">5</a>,<a href="#id10">6</a>)</span></dt>
<dd><p>Chambon, S., Galtier, M., Arnal, P., Wainrib, G. and Gramfort, A.
(2018)A Deep Learning Architecture for Temporal Sleep Stage
Classification Using Multivariate and Multimodal Time Series.
IEEE Trans. on Neural Systems and Rehabilitation Engineering 26:
(758-769)</p>
</dd>
<dt class="label" id="id5"><span class="brackets"><a class="fn-backref" href="#id3">2</a></span></dt>
<dd><p>B Kemp, AH Zwinderman, B Tuk, HAC Kamphuisen, JJL Oberyé. Analysis of
a sleep-dependent neuronal feedback loop: the slow-wave
microcontinuity of the EEG. IEEE-BME 47(9):1185-1194 (2000).</p>
</dd>
<dt class="label" id="id6"><span class="brackets">3</span></dt>
<dd><p>Goldberger AL, Amaral LAN, Glass L, Hausdorff JM, Ivanov PCh,
Mark RG, Mietus JE, Moody GB, Peng C-K, Stanley HE. (2000)
PhysioBank, PhysioToolkit, and PhysioNet: Components of a New
Research Resource for Complex Physiologic Signals.
Circulation 101(23):e215-e220</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Authors: Hubert Banville &lt;hubert.jbanville@gmail.com&gt;</span>
<span class="c1">#</span>
<span class="c1"># License: BSD (3-clause)</span>
</pre></div>
</div>
</div>
<div class="section" id="loading-and-preprocessing-the-dataset">
<h2>Loading and preprocessing the dataset<a class="headerlink" href="#loading-and-preprocessing-the-dataset" title="Permalink to this headline">¶</a></h2>
<div class="section" id="loading">
<h3>Loading<a class="headerlink" href="#loading" title="Permalink to this headline">¶</a></h3>
<p>First, we load the data using the
<code class="xref py py-class docutils literal notranslate"><span class="pre">braindecode.datasets.sleep_physionet.SleepPhysionet</span></code> class. We load
two recordings from two different individuals: we will use the first one to
train our network and the second one to evaluate performance (as in the <a class="reference external" href="https://mne.tools/stable/auto_tutorials/sample-datasets/plot_sleep.html">MNE</a>
sleep staging example).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To load your own datasets either via MNE or from
preprocessed X/y numpy arrays, see the <a class="reference external" href="./plot_mne_dataset_example.html">MNE Dataset
Tutorial</a> and the <a class="reference external" href="./plot_custom_dataset_example.html">Numpy Dataset
Tutorial</a>.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">braindecode.datasets.sleep_physionet</span> <span class="kn">import</span> <a href="../generated/braindecode.datasets.BaseConcatDataset.html#braindecode.datasets.BaseConcatDataset" title="braindecode.datasets.BaseConcatDataset" class="sphx-glr-backref-module-braindecode-datasets sphx-glr-backref-type-py-class"><span class="n">SleepPhysionet</span></a>

<span class="n">dataset</span> <span class="o">=</span> <a href="../generated/braindecode.datasets.BaseConcatDataset.html#braindecode.datasets.BaseConcatDataset" title="braindecode.datasets.BaseConcatDataset" class="sphx-glr-backref-module-braindecode-datasets sphx-glr-backref-type-py-class"><span class="n">SleepPhysionet</span></a><span class="p">(</span>
    <span class="n">subject_ids</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">recording_ids</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">crop_wake_mins</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Using default location ~/mne_data for PHYSIONET_SLEEP...
Downloading https://physionet.org/physiobank/database/sleep-edfx/sleep-cassette//SC4001E0-PSG.edf (46.1 MB)

  0%|          | Downloading : 0.00/46.1M [00:00&lt;?,        ?B/s]
  0%|          | Downloading : 88.0k/46.1M [00:00&lt;00:13,    3.55MB/s]
  0%|          | Downloading : 152k/46.1M [00:00&lt;00:13,    3.49MB/s]
  0%|          | Downloading : 216k/46.1M [00:00&lt;00:13,    3.46MB/s]
  1%|          | Downloading : 280k/46.1M [00:00&lt;00:13,    3.49MB/s]
  1%|          | Downloading : 344k/46.1M [00:00&lt;00:13,    3.46MB/s]
  1%|          | Downloading : 472k/46.1M [00:00&lt;00:13,    3.51MB/s]
  1%|1         | Downloading : 536k/46.1M [00:00&lt;00:13,    3.49MB/s]
  1%|1         | Downloading : 664k/46.1M [00:00&lt;00:13,    3.53MB/s]
  2%|1         | Downloading : 792k/46.1M [00:00&lt;00:13,    3.59MB/s]
  2%|1         | Downloading : 920k/46.1M [00:00&lt;00:12,    3.65MB/s]
  2%|2         | Downloading : 1.09M/46.1M [00:00&lt;00:12,    3.74MB/s]
  3%|2         | Downloading : 1.21M/46.1M [00:00&lt;00:12,    3.81MB/s]
  3%|3         | Downloading : 1.46M/46.1M [00:00&lt;00:11,    3.92MB/s]
  3%|3         | Downloading : 1.59M/46.1M [00:00&lt;00:11,    3.98MB/s]
  4%|3         | Downloading : 1.84M/46.1M [00:00&lt;00:11,    4.10MB/s]
  4%|4         | Downloading : 1.96M/46.1M [00:00&lt;00:11,    4.17MB/s]
  5%|4         | Downloading : 2.09M/46.1M [00:00&lt;00:10,    4.27MB/s]
  5%|4         | Downloading : 2.21M/46.1M [00:00&lt;00:10,    4.33MB/s]
  5%|5         | Downloading : 2.46M/46.1M [00:00&lt;00:10,    4.40MB/s]
  6%|5         | Downloading : 2.59M/46.1M [00:00&lt;00:10,    4.43MB/s]
  6%|5         | Downloading : 2.71M/46.1M [00:00&lt;00:10,    4.44MB/s]
  6%|6         | Downloading : 2.84M/46.1M [00:00&lt;00:10,    4.44MB/s]
  6%|6         | Downloading : 2.96M/46.1M [00:00&lt;00:10,    4.48MB/s]
  7%|6         | Downloading : 3.09M/46.1M [00:00&lt;00:09,    4.51MB/s]
  7%|6         | Downloading : 3.21M/46.1M [00:00&lt;00:09,    4.54MB/s]
  7%|7         | Downloading : 3.34M/46.1M [00:00&lt;00:09,    4.58MB/s]
  8%|7         | Downloading : 3.46M/46.1M [00:00&lt;00:09,    4.61MB/s]
  8%|7         | Downloading : 3.59M/46.1M [00:00&lt;00:09,    4.64MB/s]
  8%|8         | Downloading : 3.71M/46.1M [00:00&lt;00:09,    4.67MB/s]
  8%|8         | Downloading : 3.84M/46.1M [00:00&lt;00:09,    4.74MB/s]
  9%|8         | Downloading : 3.96M/46.1M [00:00&lt;00:09,    4.80MB/s]
  9%|8         | Downloading : 4.09M/46.1M [00:00&lt;00:09,    4.84MB/s]
  9%|9         | Downloading : 4.21M/46.1M [00:00&lt;00:09,    4.87MB/s]
  9%|9         | Downloading : 4.34M/46.1M [00:00&lt;00:08,    4.93MB/s]
 10%|9         | Downloading : 4.46M/46.1M [00:00&lt;00:08,    5.00MB/s]
 10%|9         | Downloading : 4.59M/46.1M [00:00&lt;00:08,    4.92MB/s]
 10%|#         | Downloading : 4.71M/46.1M [00:00&lt;00:08,    4.92MB/s]
 10%|#         | Downloading : 4.84M/46.1M [00:00&lt;00:08,    4.93MB/s]
 11%|#         | Downloading : 4.96M/46.1M [00:00&lt;00:08,    4.89MB/s]
 11%|#1        | Downloading : 5.09M/46.1M [00:00&lt;00:08,    4.87MB/s]
 11%|#1        | Downloading : 5.21M/46.1M [00:01&lt;00:08,    4.88MB/s]
 12%|#1        | Downloading : 5.34M/46.1M [00:01&lt;00:08,    4.90MB/s]
 12%|#1        | Downloading : 5.46M/46.1M [00:01&lt;00:08,    4.91MB/s]
 12%|#2        | Downloading : 5.59M/46.1M [00:01&lt;00:08,    4.93MB/s]
 12%|#2        | Downloading : 5.71M/46.1M [00:01&lt;00:08,    4.95MB/s]
 13%|#2        | Downloading : 5.84M/46.1M [00:01&lt;00:08,    4.97MB/s]
 13%|#2        | Downloading : 5.96M/46.1M [00:01&lt;00:08,    5.02MB/s]
 13%|#3        | Downloading : 6.09M/46.1M [00:01&lt;00:08,    5.04MB/s]
 13%|#3        | Downloading : 6.21M/46.1M [00:01&lt;00:08,    5.06MB/s]
 14%|#3        | Downloading : 6.34M/46.1M [00:01&lt;00:08,    5.12MB/s]
 14%|#4        | Downloading : 6.46M/46.1M [00:01&lt;00:08,    5.17MB/s]
 14%|#4        | Downloading : 6.59M/46.1M [00:01&lt;00:07,    5.20MB/s]
 15%|#4        | Downloading : 6.71M/46.1M [00:01&lt;00:07,    5.26MB/s]
 15%|#4        | Downloading : 6.84M/46.1M [00:01&lt;00:07,    5.29MB/s]
 15%|#5        | Downloading : 6.96M/46.1M [00:01&lt;00:07,    5.34MB/s]
 15%|#5        | Downloading : 7.09M/46.1M [00:01&lt;00:07,    5.39MB/s]
 16%|#5        | Downloading : 7.21M/46.1M [00:01&lt;00:07,    5.44MB/s]
 16%|#5        | Downloading : 7.34M/46.1M [00:01&lt;00:07,    5.46MB/s]
 16%|#6        | Downloading : 7.59M/46.1M [00:01&lt;00:07,    5.52MB/s]
 17%|#6        | Downloading : 7.84M/46.1M [00:01&lt;00:07,    5.58MB/s]
 18%|#7        | Downloading : 8.09M/46.1M [00:01&lt;00:07,    5.60MB/s]
 18%|#7        | Downloading : 8.21M/46.1M [00:01&lt;00:07,    5.58MB/s]
 18%|#8        | Downloading : 8.34M/46.1M [00:01&lt;00:07,    5.57MB/s]
 18%|#8        | Downloading : 8.46M/46.1M [00:01&lt;00:07,    5.54MB/s]
 19%|#8        | Downloading : 8.59M/46.1M [00:01&lt;00:07,    5.53MB/s]
 19%|#8        | Downloading : 8.71M/46.1M [00:01&lt;00:07,    5.52MB/s]
 19%|#9        | Downloading : 8.84M/46.1M [00:01&lt;00:07,    5.55MB/s]
 19%|#9        | Downloading : 8.96M/46.1M [00:01&lt;00:07,    5.54MB/s]
 20%|#9        | Downloading : 9.09M/46.1M [00:01&lt;00:07,    5.48MB/s]
 20%|#9        | Downloading : 9.21M/46.1M [00:01&lt;00:07,    5.43MB/s]
 20%|##        | Downloading : 9.34M/46.1M [00:01&lt;00:07,    5.37MB/s]
 21%|##        | Downloading : 9.46M/46.1M [00:01&lt;00:07,    5.26MB/s]
 21%|##        | Downloading : 9.59M/46.1M [00:01&lt;00:07,    5.23MB/s]
 21%|##1       | Downloading : 9.71M/46.1M [00:01&lt;00:07,    5.16MB/s]
 21%|##1       | Downloading : 9.84M/46.1M [00:01&lt;00:07,    5.13MB/s]
 22%|##1       | Downloading : 9.96M/46.1M [00:01&lt;00:07,    5.09MB/s]
 22%|##1       | Downloading : 10.1M/46.1M [00:01&lt;00:07,    5.07MB/s]
 22%|##2       | Downloading : 10.2M/46.1M [00:01&lt;00:07,    5.07MB/s]
 22%|##2       | Downloading : 10.3M/46.1M [00:02&lt;00:07,    5.07MB/s]
 23%|##2       | Downloading : 10.5M/46.1M [00:02&lt;00:07,    5.08MB/s]
 23%|##2       | Downloading : 10.6M/46.1M [00:02&lt;00:07,    5.08MB/s]
 23%|##3       | Downloading : 10.7M/46.1M [00:02&lt;00:07,    5.09MB/s]
 24%|##3       | Downloading : 10.8M/46.1M [00:02&lt;00:07,    5.11MB/s]
 24%|##3       | Downloading : 11.0M/46.1M [00:02&lt;00:07,    5.12MB/s]
 24%|##4       | Downloading : 11.1M/46.1M [00:02&lt;00:07,    5.13MB/s]
 24%|##4       | Downloading : 11.2M/46.1M [00:02&lt;00:07,    5.14MB/s]
 25%|##4       | Downloading : 11.3M/46.1M [00:02&lt;00:07,    5.19MB/s]
 25%|##4       | Downloading : 11.5M/46.1M [00:02&lt;00:06,    5.21MB/s]
 25%|##5       | Downloading : 11.6M/46.1M [00:02&lt;00:06,    5.27MB/s]
 25%|##5       | Downloading : 11.7M/46.1M [00:02&lt;00:06,    5.28MB/s]
 26%|##5       | Downloading : 11.8M/46.1M [00:02&lt;00:06,    5.34MB/s]
 26%|##5       | Downloading : 12.0M/46.1M [00:02&lt;00:06,    5.37MB/s]
 26%|##6       | Downloading : 12.1M/46.1M [00:02&lt;00:06,    5.40MB/s]
 26%|##6       | Downloading : 12.2M/46.1M [00:02&lt;00:06,    5.46MB/s]
 27%|##6       | Downloading : 12.3M/46.1M [00:02&lt;00:06,    5.49MB/s]
 27%|##7       | Downloading : 12.5M/46.1M [00:02&lt;00:06,    5.52MB/s]
 27%|##7       | Downloading : 12.6M/46.1M [00:02&lt;00:06,    5.58MB/s]
 28%|##7       | Downloading : 12.7M/46.1M [00:02&lt;00:06,    5.42MB/s]
 28%|##7       | Downloading : 12.8M/46.1M [00:02&lt;00:06,    5.40MB/s]
 28%|##8       | Downloading : 13.0M/46.1M [00:02&lt;00:06,    5.22MB/s]
 28%|##8       | Downloading : 13.1M/46.1M [00:02&lt;00:06,    5.10MB/s]
 29%|##8       | Downloading : 13.2M/46.1M [00:02&lt;00:06,    5.03MB/s]
 29%|##8       | Downloading : 13.3M/46.1M [00:02&lt;00:06,    4.93MB/s]
 29%|##9       | Downloading : 13.5M/46.1M [00:02&lt;00:07,    4.87MB/s]
 29%|##9       | Downloading : 13.6M/46.1M [00:02&lt;00:07,    4.85MB/s]
 30%|##9       | Downloading : 13.7M/46.1M [00:02&lt;00:07,    4.79MB/s]
 30%|###       | Downloading : 13.8M/46.1M [00:02&lt;00:07,    4.79MB/s]
 30%|###       | Downloading : 14.0M/46.1M [00:02&lt;00:07,    4.77MB/s]
 31%|###       | Downloading : 14.1M/46.1M [00:02&lt;00:07,    4.75MB/s]
 31%|###       | Downloading : 14.2M/46.1M [00:02&lt;00:07,    4.77MB/s]
 31%|###1      | Downloading : 14.3M/46.1M [00:02&lt;00:06,    4.78MB/s]
 31%|###1      | Downloading : 14.5M/46.1M [00:02&lt;00:06,    4.79MB/s]
 32%|###1      | Downloading : 14.6M/46.1M [00:02&lt;00:06,    4.82MB/s]
 32%|###1      | Downloading : 14.7M/46.1M [00:02&lt;00:06,    4.84MB/s]
 32%|###2      | Downloading : 14.8M/46.1M [00:02&lt;00:06,    4.86MB/s]
 32%|###2      | Downloading : 15.0M/46.1M [00:02&lt;00:06,    4.90MB/s]
 33%|###2      | Downloading : 15.1M/46.1M [00:03&lt;00:06,    4.92MB/s]
 33%|###2      | Downloading : 15.2M/46.1M [00:03&lt;00:06,    4.96MB/s]
 33%|###3      | Downloading : 15.3M/46.1M [00:03&lt;00:06,    4.97MB/s]
 34%|###3      | Downloading : 15.5M/46.1M [00:03&lt;00:06,    5.01MB/s]
 34%|###3      | Downloading : 15.6M/46.1M [00:03&lt;00:06,    5.02MB/s]
 34%|###4      | Downloading : 15.7M/46.1M [00:03&lt;00:06,    5.01MB/s]
 34%|###4      | Downloading : 15.8M/46.1M [00:03&lt;00:06,    4.98MB/s]
 35%|###4      | Downloading : 16.0M/46.1M [00:03&lt;00:06,    4.93MB/s]
 35%|###4      | Downloading : 16.1M/46.1M [00:03&lt;00:06,    4.91MB/s]
 35%|###5      | Downloading : 16.2M/46.1M [00:03&lt;00:06,    4.91MB/s]
 35%|###5      | Downloading : 16.3M/46.1M [00:03&lt;00:06,    4.88MB/s]
 36%|###5      | Downloading : 16.5M/46.1M [00:03&lt;00:06,    4.83MB/s]
 36%|###5      | Downloading : 16.6M/46.1M [00:03&lt;00:06,    4.74MB/s]
 36%|###6      | Downloading : 16.7M/46.1M [00:03&lt;00:06,    4.66MB/s]
 37%|###6      | Downloading : 16.8M/46.1M [00:03&lt;00:06,    4.59MB/s]
 37%|###6      | Downloading : 17.0M/46.1M [00:03&lt;00:06,    4.56MB/s]
 37%|###7      | Downloading : 17.1M/46.1M [00:03&lt;00:06,    4.52MB/s]
 37%|###7      | Downloading : 17.2M/46.1M [00:03&lt;00:06,    4.50MB/s]
 38%|###7      | Downloading : 17.3M/46.1M [00:03&lt;00:06,    4.49MB/s]
 38%|###7      | Downloading : 17.5M/46.1M [00:03&lt;00:06,    4.47MB/s]
 38%|###8      | Downloading : 17.6M/46.1M [00:03&lt;00:06,    4.46MB/s]
 38%|###8      | Downloading : 17.7M/46.1M [00:03&lt;00:06,    4.49MB/s]
 39%|###8      | Downloading : 17.8M/46.1M [00:03&lt;00:06,    4.52MB/s]
 39%|###8      | Downloading : 18.0M/46.1M [00:03&lt;00:06,    4.54MB/s]
 39%|###9      | Downloading : 18.1M/46.1M [00:03&lt;00:06,    4.55MB/s]
 40%|###9      | Downloading : 18.2M/46.1M [00:03&lt;00:06,    4.57MB/s]
 40%|###9      | Downloading : 18.3M/46.1M [00:03&lt;00:06,    4.60MB/s]
 40%|####      | Downloading : 18.5M/46.1M [00:03&lt;00:06,    4.64MB/s]
 40%|####      | Downloading : 18.6M/46.1M [00:03&lt;00:06,    4.70MB/s]
 41%|####      | Downloading : 18.7M/46.1M [00:03&lt;00:06,    4.73MB/s]
 41%|####      | Downloading : 18.8M/46.1M [00:03&lt;00:06,    4.75MB/s]
 41%|####1     | Downloading : 19.0M/46.1M [00:03&lt;00:05,    4.78MB/s]
 41%|####1     | Downloading : 19.1M/46.1M [00:03&lt;00:05,    4.82MB/s]
 42%|####1     | Downloading : 19.2M/46.1M [00:03&lt;00:05,    4.87MB/s]
 42%|####1     | Downloading : 19.3M/46.1M [00:03&lt;00:05,    4.93MB/s]
 42%|####2     | Downloading : 19.5M/46.1M [00:03&lt;00:05,    4.99MB/s]
 42%|####2     | Downloading : 19.6M/46.1M [00:03&lt;00:05,    5.03MB/s]
 43%|####2     | Downloading : 19.7M/46.1M [00:04&lt;00:05,    5.09MB/s]
 43%|####3     | Downloading : 19.8M/46.1M [00:04&lt;00:05,    5.10MB/s]
 43%|####3     | Downloading : 20.0M/46.1M [00:04&lt;00:05,    5.19MB/s]
 44%|####3     | Downloading : 20.1M/46.1M [00:04&lt;00:05,    5.24MB/s]
 44%|####3     | Downloading : 20.2M/46.1M [00:04&lt;00:05,    5.30MB/s]
 44%|####4     | Downloading : 20.3M/46.1M [00:04&lt;00:05,    5.37MB/s]
 44%|####4     | Downloading : 20.5M/46.1M [00:04&lt;00:04,    5.42MB/s]
 45%|####4     | Downloading : 20.6M/46.1M [00:04&lt;00:04,    5.49MB/s]
 45%|####4     | Downloading : 20.7M/46.1M [00:04&lt;00:04,    5.54MB/s]
 45%|####5     | Downloading : 20.8M/46.1M [00:04&lt;00:04,    5.61MB/s]
 45%|####5     | Downloading : 21.0M/46.1M [00:04&lt;00:04,    5.67MB/s]
 46%|####5     | Downloading : 21.1M/46.1M [00:04&lt;00:04,    5.73MB/s]
 46%|####6     | Downloading : 21.2M/46.1M [00:04&lt;00:04,    5.79MB/s]
 47%|####6     | Downloading : 21.5M/46.1M [00:04&lt;00:04,    5.87MB/s]
 47%|####6     | Downloading : 21.6M/46.1M [00:04&lt;00:04,    5.92MB/s]
 47%|####7     | Downloading : 21.7M/46.1M [00:04&lt;00:04,    5.97MB/s]
 48%|####7     | Downloading : 22.0M/46.1M [00:04&lt;00:04,    6.06MB/s]
 48%|####7     | Downloading : 22.1M/46.1M [00:04&lt;00:04,    6.11MB/s]
 48%|####8     | Downloading : 22.3M/46.1M [00:04&lt;00:04,    6.19MB/s]
 49%|####8     | Downloading : 22.6M/46.1M [00:04&lt;00:03,    6.27MB/s]
 49%|####9     | Downloading : 22.7M/46.1M [00:04&lt;00:03,    6.33MB/s]
 50%|####9     | Downloading : 23.0M/46.1M [00:04&lt;00:03,    6.41MB/s]
 50%|#####     | Downloading : 23.2M/46.1M [00:04&lt;00:03,    6.48MB/s]
 51%|#####     | Downloading : 23.5M/46.1M [00:04&lt;00:03,    6.59MB/s]
 51%|#####1    | Downloading : 23.7M/46.1M [00:04&lt;00:03,    6.68MB/s]
 52%|#####1    | Downloading : 23.8M/46.1M [00:04&lt;00:03,    6.70MB/s]
 52%|#####2    | Downloading : 24.1M/46.1M [00:04&lt;00:03,    6.82MB/s]
 53%|#####2    | Downloading : 24.3M/46.1M [00:04&lt;00:03,    6.91MB/s]
 53%|#####3    | Downloading : 24.6M/46.1M [00:04&lt;00:03,    6.96MB/s]
 54%|#####3    | Downloading : 24.7M/46.1M [00:04&lt;00:03,    6.85MB/s]
 54%|#####4    | Downloading : 25.1M/46.1M [00:04&lt;00:03,    6.93MB/s]
 55%|#####4    | Downloading : 25.3M/46.1M [00:04&lt;00:03,    6.94MB/s]
 56%|#####5    | Downloading : 25.6M/46.1M [00:04&lt;00:03,    6.94MB/s]
 56%|#####6    | Downloading : 25.8M/46.1M [00:04&lt;00:03,    6.94MB/s]
 57%|#####6    | Downloading : 26.1M/46.1M [00:04&lt;00:03,    6.95MB/s]
 57%|#####7    | Downloading : 26.3M/46.1M [00:04&lt;00:02,    6.97MB/s]
 58%|#####7    | Downloading : 26.6M/46.1M [00:04&lt;00:02,    7.00MB/s]
 58%|#####8    | Downloading : 26.8M/46.1M [00:04&lt;00:02,    6.95MB/s]
 59%|#####8    | Downloading : 27.1M/46.1M [00:05&lt;00:02,    6.86MB/s]
 59%|#####9    | Downloading : 27.3M/46.1M [00:05&lt;00:02,    6.79MB/s]
 60%|#####9    | Downloading : 27.6M/46.1M [00:05&lt;00:02,    6.71MB/s]
 60%|######    | Downloading : 27.8M/46.1M [00:05&lt;00:02,    6.68MB/s]
 61%|######    | Downloading : 28.1M/46.1M [00:05&lt;00:02,    6.59MB/s]
 61%|######1   | Downloading : 28.3M/46.1M [00:05&lt;00:02,    6.45MB/s]
 62%|######2   | Downloading : 28.6M/46.1M [00:05&lt;00:02,    6.33MB/s]
 63%|######2   | Downloading : 28.8M/46.1M [00:05&lt;00:02,    6.23MB/s]
 63%|######3   | Downloading : 29.1M/46.1M [00:05&lt;00:02,    6.18MB/s]
 64%|######3   | Downloading : 29.3M/46.1M [00:05&lt;00:02,    6.13MB/s]
 64%|######4   | Downloading : 29.6M/46.1M [00:05&lt;00:02,    6.11MB/s]
 65%|######4   | Downloading : 29.8M/46.1M [00:05&lt;00:02,    6.10MB/s]
 65%|######5   | Downloading : 30.1M/46.1M [00:05&lt;00:02,    6.10MB/s]
 66%|######5   | Downloading : 30.3M/46.1M [00:05&lt;00:02,    6.10MB/s]
 66%|######6   | Downloading : 30.6M/46.1M [00:05&lt;00:02,    6.11MB/s]
 67%|######6   | Downloading : 30.8M/46.1M [00:05&lt;00:02,    6.13MB/s]
 67%|######7   | Downloading : 31.1M/46.1M [00:05&lt;00:02,    6.15MB/s]
 68%|######7   | Downloading : 31.3M/46.1M [00:05&lt;00:02,    6.18MB/s]
 69%|######8   | Downloading : 31.6M/46.1M [00:05&lt;00:02,    6.22MB/s]
 69%|######9   | Downloading : 31.8M/46.1M [00:05&lt;00:02,    6.28MB/s]
 70%|######9   | Downloading : 32.1M/46.1M [00:05&lt;00:02,    6.20MB/s]
 70%|#######   | Downloading : 32.3M/46.1M [00:05&lt;00:02,    6.31MB/s]
 71%|#######   | Downloading : 32.6M/46.1M [00:06&lt;00:02,    6.19MB/s]
 71%|#######1  | Downloading : 32.8M/46.1M [00:06&lt;00:02,    6.05MB/s]
 72%|#######1  | Downloading : 33.1M/46.1M [00:06&lt;00:02,    5.89MB/s]
 72%|#######2  | Downloading : 33.3M/46.1M [00:06&lt;00:02,    5.77MB/s]
 73%|#######2  | Downloading : 33.6M/46.1M [00:06&lt;00:02,    5.68MB/s]
 73%|#######3  | Downloading : 33.8M/46.1M [00:06&lt;00:02,    5.61MB/s]
 74%|#######3  | Downloading : 34.1M/46.1M [00:06&lt;00:02,    5.59MB/s]
 74%|#######4  | Downloading : 34.3M/46.1M [00:06&lt;00:02,    5.57MB/s]
 75%|#######5  | Downloading : 34.6M/46.1M [00:06&lt;00:02,    5.56MB/s]
 76%|#######5  | Downloading : 34.8M/46.1M [00:06&lt;00:02,    5.55MB/s]
 76%|#######6  | Downloading : 35.1M/46.1M [00:06&lt;00:02,    5.58MB/s]
 77%|#######6  | Downloading : 35.3M/46.1M [00:06&lt;00:02,    5.59MB/s]
 77%|#######7  | Downloading : 35.6M/46.1M [00:06&lt;00:01,    5.62MB/s]
 78%|#######7  | Downloading : 35.8M/46.1M [00:06&lt;00:01,    5.67MB/s]
 78%|#######8  | Downloading : 36.1M/46.1M [00:06&lt;00:01,    5.70MB/s]
 79%|#######8  | Downloading : 36.3M/46.1M [00:06&lt;00:01,    5.75MB/s]
 79%|#######9  | Downloading : 36.6M/46.1M [00:06&lt;00:01,    5.73MB/s]
 80%|#######9  | Downloading : 36.8M/46.1M [00:06&lt;00:01,    5.78MB/s]
 80%|########  | Downloading : 37.1M/46.1M [00:06&lt;00:01,    5.74MB/s]
 81%|########  | Downloading : 37.3M/46.1M [00:06&lt;00:01,    5.71MB/s]
 82%|########1 | Downloading : 37.6M/46.1M [00:07&lt;00:01,    5.63MB/s]
 82%|########2 | Downloading : 37.8M/46.1M [00:07&lt;00:01,    5.52MB/s]
 83%|########2 | Downloading : 38.1M/46.1M [00:07&lt;00:01,    5.43MB/s]
 83%|########3 | Downloading : 38.3M/46.1M [00:07&lt;00:01,    5.38MB/s]
 84%|########3 | Downloading : 38.6M/46.1M [00:07&lt;00:01,    5.36MB/s]
 84%|########4 | Downloading : 38.8M/46.1M [00:07&lt;00:01,    5.35MB/s]
 85%|########4 | Downloading : 39.1M/46.1M [00:07&lt;00:01,    5.35MB/s]
 85%|########5 | Downloading : 39.3M/46.1M [00:07&lt;00:01,    5.34MB/s]
 86%|########5 | Downloading : 39.6M/46.1M [00:07&lt;00:01,    5.35MB/s]
 86%|########6 | Downloading : 39.8M/46.1M [00:07&lt;00:01,    5.39MB/s]
 87%|########6 | Downloading : 40.1M/46.1M [00:07&lt;00:01,    5.41MB/s]
 87%|########7 | Downloading : 40.3M/46.1M [00:07&lt;00:01,    5.46MB/s]
 88%|########8 | Downloading : 40.6M/46.1M [00:07&lt;00:01,    5.47MB/s]
 89%|########8 | Downloading : 40.8M/46.1M [00:07&lt;00:01,    5.39MB/s]
 89%|########9 | Downloading : 41.1M/46.1M [00:07&lt;00:01,    5.17MB/s]
 90%|########9 | Downloading : 41.3M/46.1M [00:07&lt;00:01,    4.95MB/s]
 90%|######### | Downloading : 41.6M/46.1M [00:07&lt;00:00,    4.78MB/s]
 91%|######### | Downloading : 41.8M/46.1M [00:08&lt;00:00,    4.69MB/s]
 91%|#########1| Downloading : 42.1M/46.1M [00:08&lt;00:00,    4.61MB/s]
 92%|#########1| Downloading : 42.3M/46.1M [00:08&lt;00:00,    4.56MB/s]
 92%|#########2| Downloading : 42.6M/46.1M [00:08&lt;00:00,    4.54MB/s]
 93%|#########2| Downloading : 42.8M/46.1M [00:08&lt;00:00,    4.55MB/s]
 93%|#########3| Downloading : 43.1M/46.1M [00:08&lt;00:00,    4.56MB/s]
 94%|#########4| Downloading : 43.3M/46.1M [00:08&lt;00:00,    4.57MB/s]
 95%|#########4| Downloading : 43.6M/46.1M [00:08&lt;00:00,    4.60MB/s]
 95%|#########5| Downloading : 43.8M/46.1M [00:08&lt;00:00,    4.64MB/s]
 96%|#########5| Downloading : 44.1M/46.1M [00:08&lt;00:00,    4.68MB/s]
 96%|#########6| Downloading : 44.3M/46.1M [00:08&lt;00:00,    4.73MB/s]
 97%|#########6| Downloading : 44.6M/46.1M [00:08&lt;00:00,    4.78MB/s]
 97%|#########7| Downloading : 44.8M/46.1M [00:08&lt;00:00,    4.83MB/s]
 98%|#########7| Downloading : 45.1M/46.1M [00:08&lt;00:00,    4.90MB/s]
 98%|#########8| Downloading : 45.3M/46.1M [00:08&lt;00:00,    4.95MB/s]
 99%|#########8| Downloading : 45.6M/46.1M [00:08&lt;00:00,    5.03MB/s]
 99%|#########9| Downloading : 45.8M/46.1M [00:08&lt;00:00,    5.10MB/s]
100%|#########9| Downloading : 46.1M/46.1M [00:08&lt;00:00,    5.17MB/s]
100%|##########| Downloading : 46.1M/46.1M [00:08&lt;00:00,    5.43MB/s]
Verifying hash adabd3b01fc7bb75c523a974f38ee3ae4e57b40f.
Downloading https://physionet.org/physiobank/database/sleep-edfx/sleep-cassette//SC4001EC-Hypnogram.edf (5 kB)

  0%|          | Downloading : 0.00/4.51k [00:00&lt;?,        ?B/s]
100%|##########| Downloading : 4.51k/4.51k [00:00&lt;00:00,    6.96MB/s]
Verifying hash 21c998eadc8b1e3ea6727d3585186b8f76e7e70b.
Downloading https://physionet.org/physiobank/database/sleep-edfx/sleep-cassette//SC4011E0-PSG.edf (48.7 MB)

  0%|          | Downloading : 0.00/48.7M [00:00&lt;?,        ?B/s]
  0%|          | Downloading : 88.0k/48.7M [00:00&lt;00:13,    3.68MB/s]
  0%|          | Downloading : 216k/48.7M [00:00&lt;00:13,    3.66MB/s]
  1%|          | Downloading : 344k/48.7M [00:00&lt;00:13,    3.64MB/s]
  1%|1         | Downloading : 536k/48.7M [00:00&lt;00:13,    3.65MB/s]
  1%|1         | Downloading : 664k/48.7M [00:00&lt;00:14,    3.51MB/s]
  2%|1         | Downloading : 792k/48.7M [00:00&lt;00:14,    3.50MB/s]
  2%|1         | Downloading : 920k/48.7M [00:00&lt;00:15,    3.32MB/s]
  2%|2         | Downloading : 1.02M/48.7M [00:00&lt;00:15,    3.22MB/s]
  2%|2         | Downloading : 1.15M/48.7M [00:00&lt;00:15,    3.13MB/s]
  3%|2         | Downloading : 1.27M/48.7M [00:00&lt;00:16,    3.09MB/s]
  3%|2         | Downloading : 1.40M/48.7M [00:00&lt;00:15,    3.11MB/s]
  3%|3         | Downloading : 1.52M/48.7M [00:00&lt;00:16,    3.07MB/s]
  3%|3         | Downloading : 1.65M/48.7M [00:00&lt;00:16,    3.04MB/s]
  4%|3         | Downloading : 1.77M/48.7M [00:00&lt;00:16,    3.01MB/s]
  4%|3         | Downloading : 1.90M/48.7M [00:00&lt;00:16,    2.98MB/s]
  4%|4         | Downloading : 2.02M/48.7M [00:00&lt;00:16,    2.96MB/s]
  4%|4         | Downloading : 2.15M/48.7M [00:00&lt;00:16,    2.94MB/s]
  5%|4         | Downloading : 2.27M/48.7M [00:00&lt;00:16,    2.95MB/s]
  5%|4         | Downloading : 2.40M/48.7M [00:00&lt;00:16,    2.97MB/s]
  5%|5         | Downloading : 2.52M/48.7M [00:00&lt;00:16,    2.99MB/s]
  5%|5         | Downloading : 2.65M/48.7M [00:01&lt;00:16,    2.93MB/s]
  6%|5         | Downloading : 2.77M/48.7M [00:01&lt;00:16,    2.91MB/s]
  6%|5         | Downloading : 2.90M/48.7M [00:01&lt;00:16,    2.92MB/s]
  6%|6         | Downloading : 3.02M/48.7M [00:01&lt;00:16,    2.91MB/s]
  6%|6         | Downloading : 3.15M/48.7M [00:01&lt;00:16,    2.92MB/s]
  7%|6         | Downloading : 3.27M/48.7M [00:01&lt;00:16,    2.94MB/s]
  7%|6         | Downloading : 3.40M/48.7M [00:01&lt;00:16,    2.96MB/s]
  7%|7         | Downloading : 3.52M/48.7M [00:01&lt;00:15,    2.98MB/s]
  7%|7         | Downloading : 3.65M/48.7M [00:01&lt;00:15,    3.04MB/s]
  8%|7         | Downloading : 3.77M/48.7M [00:01&lt;00:15,    3.06MB/s]
  8%|7         | Downloading : 3.90M/48.7M [00:01&lt;00:15,    3.08MB/s]
  8%|8         | Downloading : 4.02M/48.7M [00:01&lt;00:14,    3.14MB/s]
  9%|8         | Downloading : 4.15M/48.7M [00:01&lt;00:14,    3.20MB/s]
  9%|8         | Downloading : 4.27M/48.7M [00:01&lt;00:14,    3.22MB/s]
  9%|9         | Downloading : 4.40M/48.7M [00:01&lt;00:14,    3.27MB/s]
  9%|9         | Downloading : 4.52M/48.7M [00:01&lt;00:13,    3.33MB/s]
 10%|9         | Downloading : 4.65M/48.7M [00:01&lt;00:13,    3.38MB/s]
 10%|9         | Downloading : 4.77M/48.7M [00:01&lt;00:13,    3.43MB/s]
 10%|#         | Downloading : 4.90M/48.7M [00:01&lt;00:13,    3.49MB/s]
 10%|#         | Downloading : 5.02M/48.7M [00:01&lt;00:12,    3.55MB/s]
 11%|#         | Downloading : 5.15M/48.7M [00:01&lt;00:12,    3.60MB/s]
 11%|#         | Downloading : 5.27M/48.7M [00:01&lt;00:12,    3.66MB/s]
 11%|#1        | Downloading : 5.40M/48.7M [00:01&lt;00:12,    3.72MB/s]
 11%|#1        | Downloading : 5.52M/48.7M [00:01&lt;00:11,    3.78MB/s]
 12%|#1        | Downloading : 5.65M/48.7M [00:01&lt;00:11,    3.87MB/s]
 12%|#1        | Downloading : 5.77M/48.7M [00:01&lt;00:11,    3.92MB/s]
 12%|#2        | Downloading : 5.90M/48.7M [00:01&lt;00:11,    3.98MB/s]
 12%|#2        | Downloading : 6.02M/48.7M [00:01&lt;00:11,    4.05MB/s]
 13%|#2        | Downloading : 6.15M/48.7M [00:01&lt;00:10,    4.12MB/s]
 13%|#2        | Downloading : 6.27M/48.7M [00:01&lt;00:10,    4.18MB/s]
 13%|#3        | Downloading : 6.40M/48.7M [00:01&lt;00:10,    4.25MB/s]
 13%|#3        | Downloading : 6.52M/48.7M [00:01&lt;00:10,    4.32MB/s]
 14%|#3        | Downloading : 6.65M/48.7M [00:01&lt;00:10,    4.38MB/s]
 14%|#3        | Downloading : 6.77M/48.7M [00:02&lt;00:09,    4.44MB/s]
 14%|#4        | Downloading : 6.90M/48.7M [00:02&lt;00:09,    4.53MB/s]
 14%|#4        | Downloading : 7.02M/48.7M [00:02&lt;00:09,    4.52MB/s]
 15%|#4        | Downloading : 7.27M/48.7M [00:02&lt;00:09,    4.58MB/s]
 15%|#5        | Downloading : 7.40M/48.7M [00:02&lt;00:09,    4.58MB/s]
 15%|#5        | Downloading : 7.52M/48.7M [00:02&lt;00:09,    4.59MB/s]
 16%|#5        | Downloading : 7.65M/48.7M [00:02&lt;00:09,    4.61MB/s]
 16%|#5        | Downloading : 7.77M/48.7M [00:02&lt;00:09,    4.63MB/s]
 16%|#6        | Downloading : 7.90M/48.7M [00:02&lt;00:09,    4.65MB/s]
 16%|#6        | Downloading : 8.02M/48.7M [00:02&lt;00:09,    4.65MB/s]
 17%|#6        | Downloading : 8.15M/48.7M [00:02&lt;00:09,    4.63MB/s]
 17%|#6        | Downloading : 8.27M/48.7M [00:02&lt;00:09,    4.59MB/s]
 17%|#7        | Downloading : 8.40M/48.7M [00:02&lt;00:09,    4.47MB/s]
 17%|#7        | Downloading : 8.52M/48.7M [00:02&lt;00:09,    4.50MB/s]
 18%|#7        | Downloading : 8.65M/48.7M [00:02&lt;00:09,    4.50MB/s]
 18%|#7        | Downloading : 8.77M/48.7M [00:02&lt;00:09,    4.45MB/s]
 18%|#8        | Downloading : 8.90M/48.7M [00:02&lt;00:09,    4.47MB/s]
 19%|#8        | Downloading : 9.02M/48.7M [00:02&lt;00:09,    4.49MB/s]
 19%|#8        | Downloading : 9.15M/48.7M [00:02&lt;00:09,    4.51MB/s]
 19%|#9        | Downloading : 9.27M/48.7M [00:02&lt;00:09,    4.51MB/s]
 19%|#9        | Downloading : 9.40M/48.7M [00:02&lt;00:09,    4.53MB/s]
 20%|#9        | Downloading : 9.52M/48.7M [00:02&lt;00:09,    4.56MB/s]
 20%|#9        | Downloading : 9.65M/48.7M [00:02&lt;00:08,    4.57MB/s]
 20%|##        | Downloading : 9.77M/48.7M [00:02&lt;00:08,    4.55MB/s]
 20%|##        | Downloading : 9.90M/48.7M [00:02&lt;00:09,    4.48MB/s]
 21%|##        | Downloading : 10.0M/48.7M [00:02&lt;00:09,    4.46MB/s]
 21%|##        | Downloading : 10.1M/48.7M [00:02&lt;00:09,    4.39MB/s]
 21%|##1       | Downloading : 10.3M/48.7M [00:02&lt;00:09,    4.38MB/s]
 21%|##1       | Downloading : 10.4M/48.7M [00:02&lt;00:09,    4.33MB/s]
 22%|##1       | Downloading : 10.5M/48.7M [00:02&lt;00:09,    4.36MB/s]
 22%|##1       | Downloading : 10.6M/48.7M [00:02&lt;00:09,    4.37MB/s]
 22%|##2       | Downloading : 10.8M/48.7M [00:02&lt;00:09,    4.39MB/s]
 22%|##2       | Downloading : 10.9M/48.7M [00:02&lt;00:09,    4.39MB/s]
 23%|##2       | Downloading : 11.0M/48.7M [00:02&lt;00:09,    4.39MB/s]
 23%|##2       | Downloading : 11.1M/48.7M [00:03&lt;00:08,    4.42MB/s]
 23%|##3       | Downloading : 11.3M/48.7M [00:03&lt;00:08,    4.44MB/s]
 23%|##3       | Downloading : 11.4M/48.7M [00:03&lt;00:08,    4.46MB/s]
 24%|##3       | Downloading : 11.5M/48.7M [00:03&lt;00:08,    4.49MB/s]
 24%|##3       | Downloading : 11.6M/48.7M [00:03&lt;00:08,    4.52MB/s]
 24%|##4       | Downloading : 11.8M/48.7M [00:03&lt;00:08,    4.56MB/s]
 24%|##4       | Downloading : 11.9M/48.7M [00:03&lt;00:08,    4.59MB/s]
 25%|##4       | Downloading : 12.0M/48.7M [00:03&lt;00:08,    4.64MB/s]
 25%|##4       | Downloading : 12.1M/48.7M [00:03&lt;00:08,    4.71MB/s]
 25%|##5       | Downloading : 12.3M/48.7M [00:03&lt;00:08,    4.73MB/s]
 25%|##5       | Downloading : 12.4M/48.7M [00:03&lt;00:07,    4.77MB/s]
 26%|##5       | Downloading : 12.5M/48.7M [00:03&lt;00:07,    4.82MB/s]
 26%|##5       | Downloading : 12.6M/48.7M [00:03&lt;00:07,    4.89MB/s]
 26%|##6       | Downloading : 12.8M/48.7M [00:03&lt;00:07,    4.92MB/s]
 26%|##6       | Downloading : 12.9M/48.7M [00:03&lt;00:07,    4.97MB/s]
 27%|##6       | Downloading : 13.0M/48.7M [00:03&lt;00:07,    5.04MB/s]
 27%|##6       | Downloading : 13.1M/48.7M [00:03&lt;00:07,    5.07MB/s]
 27%|##7       | Downloading : 13.3M/48.7M [00:03&lt;00:07,    5.15MB/s]
 27%|##7       | Downloading : 13.4M/48.7M [00:03&lt;00:07,    5.19MB/s]
 28%|##7       | Downloading : 13.5M/48.7M [00:03&lt;00:07,    5.27MB/s]
 28%|##8       | Downloading : 13.6M/48.7M [00:03&lt;00:06,    5.31MB/s]
 28%|##8       | Downloading : 13.8M/48.7M [00:03&lt;00:06,    5.38MB/s]
 29%|##8       | Downloading : 13.9M/48.7M [00:03&lt;00:06,    5.43MB/s]
 29%|##8       | Downloading : 14.0M/48.7M [00:03&lt;00:06,    5.50MB/s]
 29%|##9       | Downloading : 14.1M/48.7M [00:03&lt;00:06,    5.57MB/s]
 29%|##9       | Downloading : 14.3M/48.7M [00:03&lt;00:06,    5.65MB/s]
 30%|##9       | Downloading : 14.4M/48.7M [00:03&lt;00:06,    5.67MB/s]
 30%|##9       | Downloading : 14.5M/48.7M [00:03&lt;00:06,    5.75MB/s]
 30%|###       | Downloading : 14.6M/48.7M [00:03&lt;00:06,    5.81MB/s]
 30%|###       | Downloading : 14.8M/48.7M [00:03&lt;00:06,    5.87MB/s]
 31%|###       | Downloading : 14.9M/48.7M [00:03&lt;00:05,    5.95MB/s]
 31%|###       | Downloading : 15.0M/48.7M [00:03&lt;00:05,    6.02MB/s]
 31%|###1      | Downloading : 15.1M/48.7M [00:03&lt;00:05,    6.07MB/s]
 32%|###1      | Downloading : 15.4M/48.7M [00:03&lt;00:05,    6.14MB/s]
 32%|###1      | Downloading : 15.5M/48.7M [00:03&lt;00:05,    6.19MB/s]
 32%|###2      | Downloading : 15.8M/48.7M [00:03&lt;00:05,    6.26MB/s]
 33%|###2      | Downloading : 15.9M/48.7M [00:03&lt;00:05,    6.25MB/s]
 33%|###2      | Downloading : 16.0M/48.7M [00:03&lt;00:05,    6.31MB/s]
 33%|###3      | Downloading : 16.1M/48.7M [00:03&lt;00:05,    6.30MB/s]
 33%|###3      | Downloading : 16.3M/48.7M [00:03&lt;00:05,    6.24MB/s]
 34%|###3      | Downloading : 16.4M/48.7M [00:03&lt;00:05,    6.27MB/s]
 34%|###3      | Downloading : 16.5M/48.7M [00:03&lt;00:05,    6.22MB/s]
 34%|###4      | Downloading : 16.6M/48.7M [00:03&lt;00:05,    6.21MB/s]
 34%|###4      | Downloading : 16.8M/48.7M [00:03&lt;00:05,    6.16MB/s]
 35%|###4      | Downloading : 16.9M/48.7M [00:03&lt;00:05,    6.20MB/s]
 35%|###4      | Downloading : 17.0M/48.7M [00:03&lt;00:05,    6.20MB/s]
 35%|###5      | Downloading : 17.1M/48.7M [00:04&lt;00:05,    6.25MB/s]
 35%|###5      | Downloading : 17.3M/48.7M [00:04&lt;00:05,    6.19MB/s]
 36%|###5      | Downloading : 17.5M/48.7M [00:04&lt;00:05,    6.22MB/s]
 36%|###6      | Downloading : 17.6M/48.7M [00:04&lt;00:05,    6.23MB/s]
 36%|###6      | Downloading : 17.8M/48.7M [00:04&lt;00:05,    6.26MB/s]
 37%|###6      | Downloading : 17.9M/48.7M [00:04&lt;00:05,    6.28MB/s]
 37%|###6      | Downloading : 18.0M/48.7M [00:04&lt;00:05,    6.32MB/s]
 37%|###7      | Downloading : 18.3M/48.7M [00:04&lt;00:05,    6.34MB/s]
 38%|###8      | Downloading : 18.5M/48.7M [00:04&lt;00:04,    6.40MB/s]
 38%|###8      | Downloading : 18.6M/48.7M [00:04&lt;00:04,    6.43MB/s]
 39%|###8      | Downloading : 18.8M/48.7M [00:04&lt;00:04,    6.44MB/s]
 39%|###8      | Downloading : 18.9M/48.7M [00:04&lt;00:04,    6.49MB/s]
 39%|###9      | Downloading : 19.1M/48.7M [00:04&lt;00:04,    6.54MB/s]
 40%|###9      | Downloading : 19.3M/48.7M [00:04&lt;00:04,    6.57MB/s]
 40%|####      | Downloading : 19.5M/48.7M [00:04&lt;00:04,    6.63MB/s]
 41%|####      | Downloading : 19.8M/48.7M [00:04&lt;00:04,    6.69MB/s]
 41%|####1     | Downloading : 20.0M/48.7M [00:04&lt;00:04,    6.75MB/s]
 41%|####1     | Downloading : 20.1M/48.7M [00:04&lt;00:04,    6.62MB/s]
 42%|####2     | Downloading : 20.5M/48.7M [00:04&lt;00:04,    6.66MB/s]
 43%|####2     | Downloading : 20.8M/48.7M [00:04&lt;00:04,    6.62MB/s]
 43%|####3     | Downloading : 21.0M/48.7M [00:04&lt;00:04,    6.62MB/s]
 44%|####3     | Downloading : 21.3M/48.7M [00:04&lt;00:04,    6.57MB/s]
 44%|####4     | Downloading : 21.5M/48.7M [00:04&lt;00:04,    6.57MB/s]
 45%|####4     | Downloading : 21.8M/48.7M [00:04&lt;00:04,    6.56MB/s]
 45%|####5     | Downloading : 22.0M/48.7M [00:04&lt;00:04,    6.57MB/s]
 46%|####5     | Downloading : 22.3M/48.7M [00:04&lt;00:04,    6.59MB/s]
 46%|####6     | Downloading : 22.5M/48.7M [00:04&lt;00:04,    6.63MB/s]
 47%|####6     | Downloading : 22.8M/48.7M [00:04&lt;00:04,    6.64MB/s]
 47%|####7     | Downloading : 23.0M/48.7M [00:04&lt;00:04,    6.71MB/s]
 48%|####7     | Downloading : 23.3M/48.7M [00:04&lt;00:03,    6.72MB/s]
 48%|####8     | Downloading : 23.5M/48.7M [00:04&lt;00:03,    6.76MB/s]
 49%|####8     | Downloading : 23.8M/48.7M [00:04&lt;00:03,    6.83MB/s]
 49%|####9     | Downloading : 24.0M/48.7M [00:05&lt;00:03,    6.84MB/s]
 50%|####9     | Downloading : 24.3M/48.7M [00:05&lt;00:03,    6.94MB/s]
 50%|#####     | Downloading : 24.5M/48.7M [00:05&lt;00:03,    6.95MB/s]
 51%|#####     | Downloading : 24.8M/48.7M [00:05&lt;00:03,    7.04MB/s]
 51%|#####1    | Downloading : 25.0M/48.7M [00:05&lt;00:03,    7.09MB/s]
 52%|#####1    | Downloading : 25.3M/48.7M [00:05&lt;00:03,    7.14MB/s]
 52%|#####2    | Downloading : 25.5M/48.7M [00:05&lt;00:03,    7.22MB/s]
 53%|#####2    | Downloading : 25.8M/48.7M [00:05&lt;00:03,    7.32MB/s]
 53%|#####3    | Downloading : 26.0M/48.7M [00:05&lt;00:03,    7.32MB/s]
 54%|#####3    | Downloading : 26.3M/48.7M [00:05&lt;00:03,    7.28MB/s]
 54%|#####4    | Downloading : 26.5M/48.7M [00:05&lt;00:03,    7.24MB/s]
 55%|#####4    | Downloading : 26.8M/48.7M [00:05&lt;00:03,    7.21MB/s]
 55%|#####5    | Downloading : 27.0M/48.7M [00:05&lt;00:03,    7.18MB/s]
 56%|#####5    | Downloading : 27.3M/48.7M [00:05&lt;00:03,    7.16MB/s]
 56%|#####6    | Downloading : 27.5M/48.7M [00:05&lt;00:03,    7.16MB/s]
 57%|#####6    | Downloading : 27.8M/48.7M [00:05&lt;00:03,    7.15MB/s]
 57%|#####7    | Downloading : 28.0M/48.7M [00:05&lt;00:03,    7.16MB/s]
 58%|#####8    | Downloading : 28.3M/48.7M [00:05&lt;00:02,    7.19MB/s]
 59%|#####8    | Downloading : 28.5M/48.7M [00:05&lt;00:02,    7.20MB/s]
 59%|#####9    | Downloading : 28.8M/48.7M [00:05&lt;00:02,    7.22MB/s]
 60%|#####9    | Downloading : 29.0M/48.7M [00:05&lt;00:02,    7.28MB/s]
 60%|######    | Downloading : 29.3M/48.7M [00:05&lt;00:02,    7.27MB/s]
 61%|######    | Downloading : 29.5M/48.7M [00:05&lt;00:02,    7.22MB/s]
 61%|######1   | Downloading : 29.8M/48.7M [00:05&lt;00:02,    7.09MB/s]
 62%|######1   | Downloading : 30.0M/48.7M [00:05&lt;00:02,    7.06MB/s]
 62%|######2   | Downloading : 30.3M/48.7M [00:05&lt;00:02,    6.97MB/s]
 63%|######2   | Downloading : 30.5M/48.7M [00:05&lt;00:02,    6.94MB/s]
 63%|######3   | Downloading : 30.8M/48.7M [00:06&lt;00:02,    6.92MB/s]
 64%|######3   | Downloading : 31.0M/48.7M [00:06&lt;00:02,    6.90MB/s]
 64%|######4   | Downloading : 31.3M/48.7M [00:06&lt;00:02,    6.78MB/s]
 65%|######4   | Downloading : 31.5M/48.7M [00:06&lt;00:02,    6.59MB/s]
 65%|######5   | Downloading : 31.8M/48.7M [00:06&lt;00:02,    6.49MB/s]
 66%|######5   | Downloading : 32.0M/48.7M [00:06&lt;00:02,    6.48MB/s]
 66%|######6   | Downloading : 32.3M/48.7M [00:06&lt;00:02,    6.39MB/s]
 67%|######6   | Downloading : 32.5M/48.7M [00:06&lt;00:02,    6.33MB/s]
 67%|######7   | Downloading : 32.8M/48.7M [00:06&lt;00:02,    6.32MB/s]
 68%|######7   | Downloading : 33.0M/48.7M [00:06&lt;00:02,    6.34MB/s]
 68%|######8   | Downloading : 33.3M/48.7M [00:06&lt;00:02,    6.31MB/s]
 69%|######8   | Downloading : 33.5M/48.7M [00:06&lt;00:02,    6.30MB/s]
 69%|######9   | Downloading : 33.8M/48.7M [00:06&lt;00:02,    6.32MB/s]
 70%|######9   | Downloading : 34.0M/48.7M [00:06&lt;00:02,    6.34MB/s]
 70%|#######   | Downloading : 34.3M/48.7M [00:06&lt;00:02,    6.34MB/s]
 71%|#######   | Downloading : 34.5M/48.7M [00:06&lt;00:02,    6.39MB/s]
 71%|#######1  | Downloading : 34.8M/48.7M [00:06&lt;00:02,    6.28MB/s]
 72%|#######1  | Downloading : 35.0M/48.7M [00:06&lt;00:02,    6.21MB/s]
 72%|#######2  | Downloading : 35.3M/48.7M [00:06&lt;00:02,    6.14MB/s]
 73%|#######2  | Downloading : 35.5M/48.7M [00:06&lt;00:02,    6.13MB/s]
 73%|#######3  | Downloading : 35.8M/48.7M [00:06&lt;00:02,    6.10MB/s]
 74%|#######3  | Downloading : 36.0M/48.7M [00:06&lt;00:02,    6.10MB/s]
 74%|#######4  | Downloading : 36.3M/48.7M [00:07&lt;00:02,    6.07MB/s]
 75%|#######4  | Downloading : 36.5M/48.7M [00:07&lt;00:02,    6.09MB/s]
 75%|#######5  | Downloading : 36.8M/48.7M [00:07&lt;00:02,    5.96MB/s]
 76%|#######5  | Downloading : 37.0M/48.7M [00:07&lt;00:02,    5.71MB/s]
 76%|#######6  | Downloading : 37.3M/48.7M [00:07&lt;00:02,    5.55MB/s]
 77%|#######6  | Downloading : 37.5M/48.7M [00:07&lt;00:02,    5.42MB/s]
 77%|#######7  | Downloading : 37.8M/48.7M [00:07&lt;00:02,    5.34MB/s]
 78%|#######8  | Downloading : 38.0M/48.7M [00:07&lt;00:02,    5.27MB/s]
 79%|#######8  | Downloading : 38.3M/48.7M [00:07&lt;00:02,    5.25MB/s]
 79%|#######9  | Downloading : 38.5M/48.7M [00:07&lt;00:02,    5.20MB/s]
 80%|#######9  | Downloading : 38.8M/48.7M [00:07&lt;00:02,    5.20MB/s]
 80%|########  | Downloading : 39.0M/48.7M [00:07&lt;00:01,    5.19MB/s]
 81%|########  | Downloading : 39.3M/48.7M [00:07&lt;00:01,    5.21MB/s]
 81%|########1 | Downloading : 39.5M/48.7M [00:07&lt;00:01,    5.24MB/s]
 82%|########1 | Downloading : 39.8M/48.7M [00:07&lt;00:01,    5.27MB/s]
 82%|########2 | Downloading : 40.0M/48.7M [00:07&lt;00:01,    5.30MB/s]
 83%|########2 | Downloading : 40.3M/48.7M [00:07&lt;00:01,    5.34MB/s]
 83%|########3 | Downloading : 40.5M/48.7M [00:07&lt;00:01,    5.38MB/s]
 84%|########3 | Downloading : 40.8M/48.7M [00:07&lt;00:01,    5.43MB/s]
 84%|########4 | Downloading : 41.0M/48.7M [00:08&lt;00:01,    5.48MB/s]
 85%|########4 | Downloading : 41.3M/48.7M [00:08&lt;00:01,    5.53MB/s]
 85%|########5 | Downloading : 41.5M/48.7M [00:08&lt;00:01,    5.60MB/s]
 86%|########5 | Downloading : 41.8M/48.7M [00:08&lt;00:01,    5.65MB/s]
 86%|########6 | Downloading : 42.0M/48.7M [00:08&lt;00:01,    5.73MB/s]
 87%|########6 | Downloading : 42.3M/48.7M [00:08&lt;00:01,    5.80MB/s]
 87%|########7 | Downloading : 42.5M/48.7M [00:08&lt;00:01,    5.86MB/s]
 88%|########7 | Downloading : 42.8M/48.7M [00:08&lt;00:01,    5.95MB/s]
 88%|########8 | Downloading : 43.0M/48.7M [00:08&lt;00:00,    6.02MB/s]
 89%|########8 | Downloading : 43.3M/48.7M [00:08&lt;00:00,    6.10MB/s]
 89%|########9 | Downloading : 43.5M/48.7M [00:08&lt;00:00,    6.18MB/s]
 90%|########9 | Downloading : 43.8M/48.7M [00:08&lt;00:00,    6.26MB/s]
 90%|######### | Downloading : 44.0M/48.7M [00:08&lt;00:00,    6.34MB/s]
 91%|######### | Downloading : 44.3M/48.7M [00:08&lt;00:00,    6.44MB/s]
 91%|#########1| Downloading : 44.5M/48.7M [00:08&lt;00:00,    6.51MB/s]
 92%|#########1| Downloading : 44.8M/48.7M [00:08&lt;00:00,    6.60MB/s]
 92%|#########2| Downloading : 45.0M/48.7M [00:08&lt;00:00,    6.70MB/s]
 93%|#########2| Downloading : 45.3M/48.7M [00:08&lt;00:00,    6.78MB/s]
 93%|#########3| Downloading : 45.5M/48.7M [00:08&lt;00:00,    6.87MB/s]
 94%|#########3| Downloading : 45.8M/48.7M [00:08&lt;00:00,    6.97MB/s]
 94%|#########4| Downloading : 46.0M/48.7M [00:08&lt;00:00,    7.06MB/s]
 95%|#########4| Downloading : 46.3M/48.7M [00:08&lt;00:00,    7.15MB/s]
 95%|#########5| Downloading : 46.5M/48.7M [00:08&lt;00:00,    7.25MB/s]
 96%|#########5| Downloading : 46.8M/48.7M [00:08&lt;00:00,    7.35MB/s]
 96%|#########6| Downloading : 47.0M/48.7M [00:08&lt;00:00,    7.44MB/s]
 97%|#########6| Downloading : 47.3M/48.7M [00:08&lt;00:00,    7.54MB/s]
 97%|#########7| Downloading : 47.5M/48.7M [00:08&lt;00:00,    7.63MB/s]
 98%|#########8| Downloading : 47.8M/48.7M [00:08&lt;00:00,    7.73MB/s]
 99%|#########8| Downloading : 48.0M/48.7M [00:08&lt;00:00,    7.83MB/s]
 99%|#########9| Downloading : 48.3M/48.7M [00:08&lt;00:00,    7.78MB/s]
100%|#########9| Downloading : 48.5M/48.7M [00:08&lt;00:00,    7.95MB/s]
100%|##########| Downloading : 48.7M/48.7M [00:08&lt;00:00,    7.98MB/s]
100%|##########| Downloading : 48.7M/48.7M [00:08&lt;00:00,    5.70MB/s]
Verifying hash 4d17451f7847355bcab17584de05e7e1df58c660.
Downloading https://physionet.org/physiobank/database/sleep-edfx/sleep-cassette//SC4011EH-Hypnogram.edf (4 kB)

  0%|          | Downloading : 0.00/3.80k [00:00&lt;?,        ?B/s]
100%|##########| Downloading : 3.80k/3.80k [00:00&lt;00:00,    6.40MB/s]
Verifying hash d582a3cbe2db481a362af890bc5a2f5ca7c878dc.
Extracting EDF parameters from /home/circleci/mne_data/physionet-sleep-data/SC4001E0-PSG.edf...
EDF file detected
Setting channel info structure...
Creating raw.info structure...
Extracting EDF parameters from /home/circleci/mne_data/physionet-sleep-data/SC4011E0-PSG.edf...
EDF file detected
Setting channel info structure...
Creating raw.info structure...
</pre></div>
</div>
</div>
<div class="section" id="preprocessing">
<h3>Preprocessing<a class="headerlink" href="#preprocessing" title="Permalink to this headline">¶</a></h3>
<p>Next, we preprocess the raw data. We apply convert the data to microvolts and
apply a lowpass filter. We omit the downsampling step of <a class="footnote-reference brackets" href="#id4" id="id7">1</a> as the Sleep
Physionet data is already sampled at a lower 100 Hz.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">braindecode.datautil.preprocess</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">MNEPreproc</span><span class="p">,</span> <span class="n">NumpyPreproc</span><span class="p">,</span> <span class="n">preprocess</span><span class="p">)</span>

<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">high_cut_hz</span></a> <span class="o">=</span> <span class="mi">30</span>

<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">preprocessors</span></a> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># convert from volt to microvolt, directly modifying the numpy array</span>
    <span class="n">NumpyPreproc</span><span class="p">(</span><span class="n">fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">),</span>
    <span class="c1"># bandpass filter</span>
    <span class="n">MNEPreproc</span><span class="p">(</span><span class="n">fn</span><span class="o">=</span><span class="s1">&#39;filter&#39;</span><span class="p">,</span> <span class="n">l_freq</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">h_freq</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">high_cut_hz</span></a><span class="p">),</span>
<span class="p">]</span>

<span class="c1"># Transform the data</span>
<span class="n">preprocess</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">preprocessors</span></a><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Reading 0 ... 2508000  =      0.000 ... 25080.000 secs...
Filtering raw data in 1 contiguous segment
Setting up low-pass filter at 30 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal lowpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Upper passband edge: 30.00 Hz
- Upper transition bandwidth: 7.50 Hz (-6 dB cutoff frequency: 33.75 Hz)
- Filter length: 45 samples (0.450 sec)

Reading 0 ... 3261000  =      0.000 ... 32610.000 secs...
Filtering raw data in 1 contiguous segment
Setting up low-pass filter at 30 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal lowpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Upper passband edge: 30.00 Hz
- Upper transition bandwidth: 7.50 Hz (-6 dB cutoff frequency: 33.75 Hz)
- Filter length: 45 samples (0.450 sec)
</pre></div>
</div>
</div>
<div class="section" id="extract-windows">
<h3>Extract windows<a class="headerlink" href="#extract-windows" title="Permalink to this headline">¶</a></h3>
<p>We extract 30-s windows to be used in the classification task.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">braindecode.datautil.windowers</span> <span class="kn">import</span> <a href="../generated/braindecode.datautil.create_windows_from_events.html#braindecode.datautil.create_windows_from_events" title="braindecode.datautil.create_windows_from_events" class="sphx-glr-backref-module-braindecode-datautil sphx-glr-backref-type-py-function"><span class="n">create_windows_from_events</span></a>


<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mapping</span></a> <span class="o">=</span> <span class="p">{</span>  <span class="c1"># We merge stages 3 and 4 following AASM standards.</span>
    <span class="s1">&#39;Sleep stage W&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;Sleep stage 1&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;Sleep stage 2&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s1">&#39;Sleep stage 3&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="s1">&#39;Sleep stage 4&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="s1">&#39;Sleep stage R&#39;</span><span class="p">:</span> <span class="mi">4</span>
<span class="p">}</span>

<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">window_size_s</span></a> <span class="o">=</span> <span class="mi">30</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sfreq</span></a> <span class="o">=</span> <span class="mi">100</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">window_size_samples</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">window_size_s</span></a> <span class="o">*</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sfreq</span></a>

<a href="../generated/braindecode.datasets.BaseConcatDataset.html#braindecode.datasets.BaseConcatDataset" title="braindecode.datasets.BaseConcatDataset" class="sphx-glr-backref-module-braindecode-datasets sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">windows_dataset</span></a> <span class="o">=</span> <a href="../generated/braindecode.datautil.create_windows_from_events.html#braindecode.datautil.create_windows_from_events" title="braindecode.datautil.create_windows_from_events" class="sphx-glr-backref-module-braindecode-datautil sphx-glr-backref-type-py-function"><span class="n">create_windows_from_events</span></a><span class="p">(</span>
    <span class="n">dataset</span><span class="p">,</span> <span class="n">trial_start_offset_samples</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">trial_stop_offset_samples</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">window_size_samples</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">window_size_samples</span></a><span class="p">,</span>
    <span class="n">window_stride_samples</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">window_size_samples</span></a><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mapping</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mapping</span></a><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Used Annotations descriptions: [&#39;Sleep stage 1&#39;, &#39;Sleep stage 2&#39;, &#39;Sleep stage 3&#39;, &#39;Sleep stage 4&#39;, &#39;Sleep stage R&#39;, &#39;Sleep stage W&#39;]
Adding metadata with 4 columns
Replacing existing metadata with 4 columns
837 matching events found
No baseline correction applied
0 projection items activated
Loading data for 837 events and 3000 original time points ...
0 bad epochs dropped
Used Annotations descriptions: [&#39;Sleep stage 1&#39;, &#39;Sleep stage 2&#39;, &#39;Sleep stage 3&#39;, &#39;Sleep stage 4&#39;, &#39;Sleep stage R&#39;, &#39;Sleep stage W&#39;]
Adding metadata with 4 columns
Replacing existing metadata with 4 columns
1088 matching events found
No baseline correction applied
0 projection items activated
Loading data for 1088 events and 3000 original time points ...
0 bad epochs dropped
</pre></div>
</div>
</div>
<div class="section" id="window-preprocessing">
<h3>Window preprocessing<a class="headerlink" href="#window-preprocessing" title="Permalink to this headline">¶</a></h3>
<p>We also preprocess the windows by applying channel-wise z-score normalization
in each window.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">braindecode.datautil.preprocess</span> <span class="kn">import</span> <a href="../generated/braindecode.datautil.zscore.html#braindecode.datautil.zscore" title="braindecode.datautil.zscore" class="sphx-glr-backref-module-braindecode-datautil sphx-glr-backref-type-py-function"><span class="n">zscore</span></a>

<span class="n">preprocess</span><span class="p">(</span><a href="../generated/braindecode.datasets.BaseConcatDataset.html#braindecode.datasets.BaseConcatDataset" title="braindecode.datasets.BaseConcatDataset" class="sphx-glr-backref-module-braindecode-datasets sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">windows_dataset</span></a><span class="p">,</span> <span class="p">[</span><span class="n">MNEPreproc</span><span class="p">(</span><span class="n">fn</span><span class="o">=</span><a href="../generated/braindecode.datautil.zscore.html#braindecode.datautil.zscore" title="braindecode.datautil.zscore" class="sphx-glr-backref-module-braindecode-datautil sphx-glr-backref-type-py-function"><span class="n">zscore</span></a><span class="p">)])</span>
</pre></div>
</div>
</div>
<div class="section" id="split-dataset-into-train-and-valid">
<h3>Split dataset into train and valid<a class="headerlink" href="#split-dataset-into-train-and-valid" title="Permalink to this headline">¶</a></h3>
<p>We can easily split the dataset using additional info stored in the
<cite>description</cite> attribute of <a class="reference internal" href="../generated/braindecode.datasets.BaseDataset.html#braindecode.datasets.BaseDataset" title="braindecode.datasets.BaseDataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">braindecode.datasets.BaseDataset</span></code></a>,
in this case using the <code class="docutils literal notranslate"><span class="pre">subject</span></code> column. Here, we split the examples per subject.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">splitted</span></a> <span class="o">=</span> <a href="../generated/braindecode.datasets.BaseConcatDataset.html#braindecode.datasets.BaseConcatDataset.split" title="braindecode.datasets.BaseConcatDataset.split" class="sphx-glr-backref-module-braindecode-datasets sphx-glr-backref-type-py-method"><span class="n">windows_dataset</span><span class="o">.</span><span class="n">split</span></a><span class="p">(</span><span class="s1">&#39;subject&#39;</span><span class="p">)</span>
<a href="../generated/braindecode.datasets.BaseConcatDataset.html#braindecode.datasets.BaseConcatDataset" title="braindecode.datasets.BaseConcatDataset" class="sphx-glr-backref-module-braindecode-datasets sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">train_set</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">splitted</span></a><span class="p">[</span><span class="s1">&#39;0&#39;</span><span class="p">]</span>
<a href="../generated/braindecode.datasets.BaseConcatDataset.html#braindecode.datasets.BaseConcatDataset" title="braindecode.datasets.BaseConcatDataset" class="sphx-glr-backref-module-braindecode-datasets sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">valid_set</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">splitted</span></a><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">]</span>

<span class="c1"># Print number of examples per class</span>
<span class="nb">print</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">train_set</span><span class="o">.</span><span class="n">datasets</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">windows</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">valid_set</span><span class="o">.</span><span class="n">datasets</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">windows</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;Epochs |  837 events (all good), 0 - 29.99 sec, baseline off, ~38.3 MB, data loaded, with metadata,
 &#39;Sleep stage 1&#39;: 58
 &#39;Sleep stage 2&#39;: 250
 &#39;Sleep stage 3&#39;: 220
 &#39;Sleep stage 4&#39;: 220
 &#39;Sleep stage R&#39;: 125
 &#39;Sleep stage W&#39;: 184&gt;
&lt;Epochs |  1088 events (all good), 0 - 29.99 sec, baseline off, ~49.8 MB, data loaded, with metadata,
 &#39;Sleep stage 1&#39;: 109
 &#39;Sleep stage 2&#39;: 562
 &#39;Sleep stage 3&#39;: 105
 &#39;Sleep stage 4&#39;: 105
 &#39;Sleep stage R&#39;: 170
 &#39;Sleep stage W&#39;: 142&gt;
</pre></div>
</div>
</div>
</div>
<div class="section" id="create-model">
<h2>Create model<a class="headerlink" href="#create-model" title="Permalink to this headline">¶</a></h2>
<p>We can now create the deep learning model. In this tutorial, we use the sleep
staging architecture introduced in <a class="footnote-reference brackets" href="#id4" id="id8">1</a>, which is a four-layer convolutional
neural network.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">braindecode.util</span> <span class="kn">import</span> <a href="../generated/braindecode.util.set_random_seeds.html#braindecode.util.set_random_seeds" title="braindecode.util.set_random_seeds" class="sphx-glr-backref-module-braindecode-util sphx-glr-backref-type-py-function"><span class="n">set_random_seeds</span></a>
<span class="kn">from</span> <span class="nn">braindecode.models</span> <span class="kn">import</span> <span class="n">SleepStagerChambon2018</span>

<a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cuda</span></a> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cuda</span></a><span class="o">.</span><span class="n">is_available</span><span class="p">()</span>  <span class="c1"># check if GPU is available</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">device</span></a> <span class="o">=</span> <span class="s1">&#39;cuda&#39;</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cuda</span></a><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s1">&#39;cpu&#39;</span>
<span class="k">if</span> <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cuda</span></a><span class="p">:</span>
    <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">torch</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">cudnn</span><span class="o">.</span><span class="n">benchmark</span></a> <span class="o">=</span> <span class="kc">True</span>
<span class="c1"># Set random seed to be able to reproduce results</span>
<a href="../generated/braindecode.util.set_random_seeds.html#braindecode.util.set_random_seeds" title="braindecode.util.set_random_seeds" class="sphx-glr-backref-module-braindecode-util sphx-glr-backref-type-py-function"><span class="n">set_random_seeds</span></a><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">87</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cuda</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cuda</span></a><span class="p">)</span>

<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_classes</span></a> <span class="o">=</span> <span class="mi">5</span>
<span class="c1"># Extract number of channels and time steps from dataset</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_channels</span></a> <span class="o">=</span> <a href="../generated/braindecode.datasets.BaseConcatDataset.html#braindecode.datasets.BaseConcatDataset" title="braindecode.datasets.BaseConcatDataset" class="sphx-glr-backref-module-braindecode-datasets sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">train_set</span></a><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">input_size_samples</span></a> <span class="o">=</span> <a href="../generated/braindecode.datasets.BaseConcatDataset.html#braindecode.datasets.BaseConcatDataset" title="braindecode.datasets.BaseConcatDataset" class="sphx-glr-backref-module-braindecode-datasets sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">train_set</span></a><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">SleepStagerChambon2018</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_channels</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sfreq</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_classes</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_classes</span></a><span class="p">,</span>
    <span class="n">input_size_s</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">input_size_samples</span></a> <span class="o">/</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sfreq</span></a>
<span class="p">)</span>

<span class="c1"># Send model to GPU</span>
<span class="k">if</span> <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cuda</span></a><span class="p">:</span>
    <span class="n">model</span><span class="o">.</span><a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cuda</span></a><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="training">
<h2>Training<a class="headerlink" href="#training" title="Permalink to this headline">¶</a></h2>
<p>We can now train our network. <code class="xref py py-class docutils literal notranslate"><span class="pre">braindecode.EEGClassifier</span></code> is a
braindecode object that is responsible for managing the training of neural
networks. It inherits from <code class="xref py py-class docutils literal notranslate"><span class="pre">skorch.NeuralNetClassifier</span></code>, so the
training logic is the same as in
<a class="reference external" href="https://skorch.readthedocs.io/en/stable/">Skorch</a>.</p>
<p><strong>Note</strong>: We use different hyperparameters from <a class="footnote-reference brackets" href="#id4" id="id9">1</a>, as
these hyperparameters were optimized on a different dataset (MASS SS3) and
with a different number of recordings. Generally speaking, it is
recommended to perform hyperparameter optimization if reusing this code on
a different dataset or with more recordings.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">skorch.helper</span> <span class="kn">import</span> <span class="n">predefined_split</span>
<span class="kn">from</span> <span class="nn">skorch.callbacks</span> <span class="kn">import</span> <span class="n">EpochScoring</span>
<span class="kn">from</span> <span class="nn">braindecode</span> <span class="kn">import</span> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.base.ClassifierMixin.html#sklearn.base.ClassifierMixin" title="sklearn.base.ClassifierMixin" class="sphx-glr-backref-module-sklearn-base sphx-glr-backref-type-py-class"><span class="n">EEGClassifier</span></a>

<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lr</span></a> <span class="o">=</span> <span class="mf">5e-4</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">batch_size</span></a> <span class="o">=</span> <span class="mi">16</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_epochs</span></a> <span class="o">=</span> <span class="mi">5</span>

<span class="n">train_bal_acc</span> <span class="o">=</span> <span class="n">EpochScoring</span><span class="p">(</span>
    <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;balanced_accuracy&#39;</span><span class="p">,</span> <span class="n">on_train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;train_bal_acc&#39;</span><span class="p">,</span>
    <span class="n">lower_is_better</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">valid_bal_acc</span> <span class="o">=</span> <span class="n">EpochScoring</span><span class="p">(</span>
    <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;balanced_accuracy&#39;</span><span class="p">,</span> <span class="n">on_train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;valid_bal_acc&#39;</span><span class="p">,</span>
    <span class="n">lower_is_better</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">callbacks</span></a> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;train_bal_acc&#39;</span><span class="p">,</span> <span class="n">train_bal_acc</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;valid_bal_acc&#39;</span><span class="p">,</span> <span class="n">valid_bal_acc</span><span class="p">)]</span>

<span class="n">clf</span> <span class="o">=</span> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.base.ClassifierMixin.html#sklearn.base.ClassifierMixin" title="sklearn.base.ClassifierMixin" class="sphx-glr-backref-module-sklearn-base sphx-glr-backref-type-py-class"><span class="n">EEGClassifier</span></a><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span>
    <span class="n">criterion</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">,</span>
    <span class="n">optimizer</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">,</span>
    <span class="n">train_split</span><span class="o">=</span><span class="n">predefined_split</span><span class="p">(</span><a href="../generated/braindecode.datasets.BaseConcatDataset.html#braindecode.datasets.BaseConcatDataset" title="braindecode.datasets.BaseConcatDataset" class="sphx-glr-backref-module-braindecode-datasets sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">valid_set</span></a><span class="p">),</span>  <span class="c1"># using valid_set for validation</span>
    <span class="n">optimizer__lr</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lr</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">batch_size</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">batch_size</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">callbacks</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">callbacks</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">device</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">device</span></a>
<span class="p">)</span>
<span class="c1"># Model training for a specified number of epochs. `y` is None as it is already</span>
<span class="c1"># supplied in the dataset.</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><a href="../generated/braindecode.datasets.BaseConcatDataset.html#braindecode.datasets.BaseConcatDataset" title="braindecode.datasets.BaseConcatDataset" class="sphx-glr-backref-module-braindecode-datasets sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">train_set</span></a><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_epochs</span></a><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>  epoch    train_bal_acc    train_loss    valid_bal_acc    valid_loss      dur
-------  ---------------  ------------  ---------------  ------------  -------
      1           [36m0.2483[0m        [32m1.4752[0m           [35m0.3525[0m        [31m1.4364[0m  11.5801
      2           [36m0.4277[0m        [32m1.1294[0m           [35m0.4570[0m        [31m1.0498[0m  8.5749
      3           [36m0.5466[0m        [32m0.8522[0m           0.4150        [31m0.9985[0m  11.6755
      4           [36m0.5960[0m        [32m0.7219[0m           [35m0.5007[0m        [31m0.9172[0m  35.5347
      5           0.5904        [32m0.7080[0m           [35m0.5616[0m        1.0147  9.2285

&lt;class &#39;braindecode.classifier.EEGClassifier&#39;&gt;[initialized](
  module_=SleepStagerChambon2018(
    (spatial_conv): Conv2d(1, 2, kernel_size=(2, 1), stride=(1, 1))
    (feature_extractor): Sequential(
      (0): Conv2d(1, 8, kernel_size=(1, 50), stride=(1, 1), padding=(0, 25))
      (1): Identity()
      (2): ReLU()
      (3): MaxPool2d(kernel_size=(1, 12), stride=(1, 12), padding=0, dilation=1, ceil_mode=False)
      (4): Conv2d(8, 8, kernel_size=(1, 50), stride=(1, 1), padding=(0, 25))
      (5): Identity()
      (6): ReLU()
      (7): MaxPool2d(kernel_size=(1, 12), stride=(1, 12), padding=0, dilation=1, ceil_mode=False)
    )
    (fc): Sequential(
      (0): Dropout(p=0.25, inplace=False)
      (1): Linear(in_features=320, out_features=5, bias=True)
    )
  ),
)
</pre></div>
</div>
</div>
<div class="section" id="plot-results">
<h2>Plot results<a class="headerlink" href="#plot-results" title="Permalink to this headline">¶</a></h2>
<p>We use the history stored by Skorch during training to plot the performance of
the model throughout training. Specifically, we plot the loss and the balanced
misclassification rate (1 - balanced accuracy) for the training and validation
sets.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.lines</span> <span class="kn">import</span> <a href="https://matplotlib.org/api/_as_gen/matplotlib.lines.Line2D.html#matplotlib.lines.Line2D" title="matplotlib.lines.Line2D" class="sphx-glr-backref-module-matplotlib-lines sphx-glr-backref-type-py-class"><span class="n">Line2D</span></a>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Extract loss and balanced accuracy values for plotting from history object</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">clf</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span>
<span class="n">df</span><span class="p">[[</span><span class="s1">&#39;train_mis_clf&#39;</span><span class="p">,</span> <span class="s1">&#39;valid_mis_clf&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span>
    <span class="p">[</span><span class="s1">&#39;train_bal_acc&#39;</span><span class="p">,</span> <span class="s1">&#39;valid_bal_acc&#39;</span><span class="p">]]</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># get percent of misclass for better visual comparison to loss</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn-talk&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="matplotlib.figure.Figure" class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fig</span></a><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="matplotlib.pyplot.subplots" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;train_loss&#39;</span><span class="p">,</span> <span class="s1">&#39;valid_loss&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<a href="https://matplotlib.org/api/_as_gen/matplotlib.axes.Axes.tick_params.html#matplotlib.axes.Axes.tick_params" title="matplotlib.axes.Axes.tick_params" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span></a><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.axes.Axes.set_ylabel.html#matplotlib.axes.Axes.set_ylabel" title="matplotlib.axes.Axes.set_ylabel" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span></a><span class="p">(</span><span class="s2">&quot;Loss&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="n">ax2</span> <span class="o">=</span> <a href="https://matplotlib.org/api/_as_gen/matplotlib.axes.Axes.twinx.html#matplotlib.axes.Axes.twinx" title="matplotlib.axes.Axes.twinx" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span></a><span class="p">()</span>  <span class="c1"># instantiate a second axes that shares the same x-axis</span>

<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;train_mis_clf&#39;</span><span class="p">,</span> <span class="s1">&#39;valid_mis_clf&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:red&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.axes.Axes.tick_params.html#matplotlib.axes.Axes.tick_params" title="matplotlib.axes.Axes.tick_params" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span></a><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;tab:red&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.axes.Axes.set_ylabel.html#matplotlib.axes.Axes.set_ylabel" title="matplotlib.axes.Axes.set_ylabel" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span></a><span class="p">(</span><span class="s1">&#39;Balanced misclassification rate [%]&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:red&#39;</span><span class="p">,</span>
               <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.axes.Axes.set_ylim.html#matplotlib.axes.Axes.set_ylim" title="matplotlib.axes.Axes.set_ylim" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span></a><span class="p">(</span><a href="https://matplotlib.org/api/_as_gen/matplotlib.axes.Axes.get_ylim.html#matplotlib.axes.Axes.get_ylim" title="matplotlib.axes.Axes.get_ylim" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax2</span><span class="o">.</span><span class="n">get_ylim</span></a><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">85</span><span class="p">)</span>  <span class="c1"># make some room for legend</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.axes.Axes.set_xlabel.html#matplotlib.axes.Axes.set_xlabel" title="matplotlib.axes.Axes.set_xlabel" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span></a><span class="p">(</span><span class="s1">&#39;Epoch&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="c1"># where some data has already been plotted to ax</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">handles</span></a> <span class="o">=</span> <span class="p">[]</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">handles</span></a><span class="o">.</span><span class="n">append</span><span class="p">(</span>
    <a href="https://matplotlib.org/api/_as_gen/matplotlib.lines.Line2D.html#matplotlib.lines.Line2D" title="matplotlib.lines.Line2D" class="sphx-glr-backref-module-matplotlib-lines sphx-glr-backref-type-py-class"><span class="n">Line2D</span></a><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Train&#39;</span><span class="p">))</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">handles</span></a><span class="o">.</span><span class="n">append</span><span class="p">(</span>
    <a href="https://matplotlib.org/api/_as_gen/matplotlib.lines.Line2D.html#matplotlib.lines.Line2D" title="matplotlib.lines.Line2D" class="sphx-glr-backref-module-matplotlib-lines sphx-glr-backref-type-py-class"><span class="n">Line2D</span></a><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Valid&#39;</span><span class="p">))</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.legend.html#matplotlib.pyplot.legend" title="matplotlib.pyplot.legend" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">legend</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">handles</span></a><span class="p">,</span> <span class="p">[</span><span class="n">h</span><span class="o">.</span><span class="n">get_label</span><span class="p">()</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">handles</span></a><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.tight_layout.html#matplotlib.pyplot.tight_layout" title="matplotlib.pyplot.tight_layout" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span></a><span class="p">()</span>
</pre></div>
</div>
<img alt="plot sleep staging" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_sleep_staging_001.png" />
<p>Finally, we also display the confusion matrix and classification report:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.confusion_matrix.html#sklearn.metrics.confusion_matrix" title="sklearn.metrics.confusion_matrix" class="sphx-glr-backref-module-sklearn-metrics sphx-glr-backref-type-py-function"><span class="n">confusion_matrix</span></a>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.classification_report.html#sklearn.metrics.classification_report" title="sklearn.metrics.classification_report" class="sphx-glr-backref-module-sklearn-metrics sphx-glr-backref-type-py-function"><span class="n">classification_report</span></a>

<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">y_true</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">valid_set</span><span class="o">.</span><span class="n">datasets</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">y_pred</span></a> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><a href="../generated/braindecode.datasets.BaseConcatDataset.html#braindecode.datasets.BaseConcatDataset" title="braindecode.datasets.BaseConcatDataset" class="sphx-glr-backref-module-braindecode-datasets sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">valid_set</span></a><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.confusion_matrix.html#sklearn.metrics.confusion_matrix" title="sklearn.metrics.confusion_matrix" class="sphx-glr-backref-module-sklearn-metrics sphx-glr-backref-type-py-function"><span class="n">confusion_matrix</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">y_true</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">y_pred</span></a><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.classification_report.html#sklearn.metrics.classification_report" title="sklearn.metrics.classification_report" class="sphx-glr-backref-module-sklearn-metrics sphx-glr-backref-type-py-function"><span class="n">classification_report</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">y_true</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">y_pred</span></a><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[[132   0   7   1   2]
 [ 70   0  21   0  18]
 [ 69   0 405  13  75]
 [  0   0  18  87   0]
 [ 59   0  55   0  56]]
/home/circleci/.local/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

           0       0.40      0.93      0.56       142
           1       0.00      0.00      0.00       109
           2       0.80      0.72      0.76       562
           3       0.86      0.83      0.84       105
           4       0.37      0.33      0.35       170

    accuracy                           0.62      1088
   macro avg       0.49      0.56      0.50      1088
weighted avg       0.61      0.62      0.60      1088
</pre></div>
</div>
<p>Our model was able to perform reasonably well given the low amount of data
available, reaching a balanced accuracy of around 55% in a 5-class
classification task (chance-level = 20%) on held-out data.</p>
<p>To further improve performance, more recordings can be included in the
training set, and various modifications can be made to the model (e.g.,
aggregating the representation of multiple consecutive windows <a class="footnote-reference brackets" href="#id4" id="id10">1</a>).</p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 1 minutes  41.105 seconds)</p>
<p><strong>Estimated memory usage:</strong>  220 MB</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-plot-sleep-staging-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/6e8734cc42665d49e95a1be079f57feb/plot_sleep_staging.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_sleep_staging.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/5bafba0488197e377d459780399abb29/plot_sleep_staging.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_sleep_staging.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="benchmark_lazy_eager_loading.html" class="btn btn-neutral float-right" title="Benchmarking eager and lazy loading" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="plot_regression.html" class="btn btn-neutral float-left" title="Regression example on fake data" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2018-2020, Braindecode developers

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>