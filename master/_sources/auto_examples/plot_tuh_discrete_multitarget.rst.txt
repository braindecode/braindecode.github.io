
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/plot_tuh_discrete_multitarget.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_plot_tuh_discrete_multitarget.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_plot_tuh_discrete_multitarget.py:

Multiple discrete targets with the TUH EEG Corpus
====================================================

In this example, we showcase usage of multiple discrete targets per recording
with the TUH EEG Corpus.

.. GENERATED FROM PYTHON SOURCE LINES 7-21

.. code-block:: default


    # Author: Lukas Gemein <l.gemein@gmail.com>
    #
    # License: BSD (3-clause)

    import mne
    from torch.utils.data.dataloader import DataLoader

    from braindecode.datasets import TUH
    from braindecode.preprocessing.windowers import create_fixed_length_windows

    mne.set_log_level('ERROR')  # avoid messages everytime a window is extracted









.. GENERATED FROM PYTHON SOURCE LINES 22-25

If you want to try this code with the actual data, please delete the next
section. We are required to mock some dataset functionality, since the data
is not available at creation time of this example.

.. GENERATED FROM PYTHON SOURCE LINES 25-28

.. code-block:: default

    from braindecode.datasets.tuh import _TUHMock as TUH  # noqa F811









.. GENERATED FROM PYTHON SOURCE LINES 29-32

We start by creating a TUH dataset. Instead of just a str, we give it
multiple strings as target names. Each of the strings has to exist as a
column in the description DataFrame.

.. GENERATED FROM PYTHON SOURCE LINES 32-44

.. code-block:: default


    TUH_PATH = 'please insert actual path to data here'
    tuh = TUH(
        path=TUH_PATH,
        recording_ids=None,
        target_name=('age', 'gender'),  # use both age and gender as decoding target
        preload=False,
        add_physician_reports=False,
    )
    tuh.description







.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>path</th>
          <th>version</th>
          <th>year</th>
          <th>month</th>
          <th>day</th>
          <th>subject</th>
          <th>session</th>
          <th>segment</th>
          <th>age</th>
          <th>gender</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>0</th>
          <td>tuh_eeg/v1.1.0/edf/02_tcp_le/000/00000058/s001...</td>
          <td>v1.1.0</td>
          <td>2003</td>
          <td>2</td>
          <td>5</td>
          <td>58</td>
          <td>1</td>
          <td>0</td>
          <td>0</td>
          <td>M</td>
        </tr>
        <tr>
          <th>1</th>
          <td>tuh_eeg/v1.1.0/edf/01_tcp_ar/099/00009932/s004...</td>
          <td>v1.1.0</td>
          <td>2014</td>
          <td>9</td>
          <td>30</td>
          <td>9932</td>
          <td>4</td>
          <td>13</td>
          <td>53</td>
          <td>F</td>
        </tr>
        <tr>
          <th>2</th>
          <td>tuh_eeg/v1.1.0/edf/03_tcp_ar_a/123/00012331/s0...</td>
          <td>v1.1.0</td>
          <td>2014</td>
          <td>12</td>
          <td>14</td>
          <td>12331</td>
          <td>3</td>
          <td>2</td>
          <td>39</td>
          <td>M</td>
        </tr>
        <tr>
          <th>3</th>
          <td>tuh_eeg/v1.1.0/edf/01_tcp_ar/000/00000000/s001...</td>
          <td>v1.1.0</td>
          <td>2015</td>
          <td>12</td>
          <td>30</td>
          <td>0</td>
          <td>1</td>
          <td>0</td>
          <td>37</td>
          <td>M</td>
        </tr>
        <tr>
          <th>4</th>
          <td>tuh_eeg/v1.2.0/edf/03_tcp_ar_a/149/00014928/s0...</td>
          <td>v1.2.0</td>
          <td>2016</td>
          <td>1</td>
          <td>15</td>
          <td>14928</td>
          <td>4</td>
          <td>7</td>
          <td>83</td>
          <td>F</td>
        </tr>
      </tbody>
    </table>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 45-48

Iterating through the dataset gives x as ndarray(n_channels x 1) as well as
the target as [age of the subject, gender of the subject]. Let's look at the last example
as it has more interesting age/gender labels (compare to the last row of the dataframe above).

.. GENERATED FROM PYTHON SOURCE LINES 48-53

.. code-block:: default

    x, y = tuh[-1]
    print('x:', x)
    print('y:', y)






.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    x: [[-1.34768577]
     [ 0.16612566]
     [ 1.13538638]
     [-2.12688371]
     [ 1.27066607]
     [ 0.42836086]
     [-1.79979313]
     [ 0.34666782]
     [-2.45363166]
     [-0.99068888]
     [-1.37990159]
     [-0.34567602]
     [-1.59732208]
     [-0.24280591]
     [ 1.12888551]
     [ 0.89879779]
     [-0.46972301]
     [ 0.49719077]
     [-2.4752747 ]
     [ 0.75263217]
     [ 2.28867574]]
    y: [83, 'F']




.. GENERATED FROM PYTHON SOURCE LINES 54-58

We will skip preprocessing steps for now, since it is not the aim of this
example. Instead, we will directly create compute windows. We specify a
mapping from genders 'M' and 'F' to integers, since this is required for
decoding.

.. GENERATED FROM PYTHON SOURCE LINES 58-73

.. code-block:: default


    tuh_windows = create_fixed_length_windows(
        tuh,
        start_offset_samples=0,
        stop_offset_samples=None,
        window_size_samples=1000,
        window_stride_samples=1000,
        drop_last_window=False,
        mapping={'M': 0, 'F': 1},  # map non-digit targets
    )
    # store the number of windows required for loading later on
    tuh_windows.set_description({
        "n_windows": [len(d) for d in tuh_windows.datasets]})









.. GENERATED FROM PYTHON SOURCE LINES 74-76

Iterating through the dataset gives x as ndarray(n_channels x 1000), y as
[age, gender], and ind. Let's look at the last example again.

.. GENERATED FROM PYTHON SOURCE LINES 76-82

.. code-block:: default

    x, y, ind = tuh_windows[-1]
    print('x:', x)
    print('y:', y)
    print('ind:', ind)






.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    x: [[ 0.00369266  0.29460508  0.18777855 ... -0.8291187   0.84701234
      -1.3476858 ]
     [-0.5218764  -0.7148386  -0.23599753 ...  0.29033008 -0.553208
       0.16612567]
     [-0.9099724   0.38652775 -0.03335066 ...  0.7249225   0.61858135
       1.1353863 ]
     ...
     [ 0.0834404   1.2616361  -1.0418835  ... -0.0745526   3.467093
      -2.4752748 ]
     [ 1.594744    0.4689659  -0.45871994 ... -0.26500988  0.63947254
       0.75263214]
     [-0.41036993 -1.2629665   0.3684067  ...  0.5936862   0.5163833
       2.2886758 ]]
    y: [83, 1]
    ind: [3, 2600, 3600]




.. GENERATED FROM PYTHON SOURCE LINES 83-85

We give the dataset to a pytorch DataLoader, such that it can be used for
model training.

.. GENERATED FROM PYTHON SOURCE LINES 85-91

.. code-block:: default

    dl = DataLoader(
        dataset=tuh_windows,
        batch_size=4,
    )









.. GENERATED FROM PYTHON SOURCE LINES 92-96

Iterating through the DataLoader gives batch_X as tensor(4 x n_channels x
1000), batch_y as [tensor([4 x age of subject]), tensor([4 x gender of
subject])], and batch_ind. We will iterate to the end to look at the last example
again.

.. GENERATED FROM PYTHON SOURCE LINES 96-101

.. code-block:: default

    for batch_X, batch_y, batch_ind in dl:
        pass
    print('batch_X:', batch_X)
    print('batch_y:', batch_y)
    print('batch_ind:', batch_ind)




.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    batch_X: tensor([[[-7.3559e-01,  4.2689e-01, -1.7327e-01,  ..., -7.7575e-01,
               1.9487e+00,  7.2581e-01],
             [-1.1749e+00,  2.7212e+00,  6.8958e-01,  ...,  1.6218e+00,
               3.8817e-01, -1.0487e+00],
             [-4.4036e-01, -7.1713e-01,  1.6521e+00,  ..., -2.0454e+00,
               6.4045e-01,  6.8176e-01],
             ...,
             [ 6.0140e-01,  7.0750e-01,  2.4931e-03,  ..., -1.9371e+00,
               1.4911e+00,  1.8965e+00],
             [ 6.5419e-01, -7.9451e-01,  2.0673e+00,  ...,  1.0185e+00,
              -8.3233e-01, -8.9322e-02],
             [-4.5254e-01,  5.4831e-01,  1.0593e-01,  ...,  6.4302e-01,
              -3.6355e-01,  4.7577e-01]],

            [[ 7.5174e-01, -1.6345e-01,  1.5626e-01,  ..., -1.0530e+00,
               2.8250e-01,  1.2442e+00],
             [-6.1519e-01, -1.2387e-01, -1.2941e+00,  ...,  5.6503e-01,
               5.7149e-01, -6.7845e-01],
             [-4.2817e-01,  8.9124e-01,  2.0732e-01,  ..., -3.5671e-01,
              -5.6905e-01, -5.5374e-01],
             ...,
             [-2.9025e-02,  1.5374e+00,  2.2202e+00,  ...,  7.8946e-01,
               1.2774e+00,  1.3614e-01],
             [ 9.3808e-01,  5.9129e-02, -5.5075e-01,  ..., -1.0704e+00,
               1.0172e+00, -1.5139e+00],
             [ 2.2515e-01,  1.1386e+00, -1.8250e+00,  ...,  9.7730e-01,
               1.3534e+00, -1.6825e+00]],

            [[-1.8162e+00,  5.4738e-01,  1.9817e-01,  ...,  1.0620e+00,
               8.4884e-01,  8.4955e-01],
             [ 4.4326e-01, -9.6844e-01, -3.4087e-01,  ..., -6.8979e-01,
              -1.9243e+00, -5.8012e-01],
             [-5.3978e-02,  5.4691e-01,  5.6489e-02,  ..., -9.0797e-01,
               8.8843e-01, -1.1873e+00],
             ...,
             [-8.5455e-01,  3.4111e-01, -1.5243e+00,  ..., -1.1267e+00,
              -9.5759e-01, -3.5345e-01],
             [ 1.1328e+00,  4.6758e-01,  3.0863e-01,  ..., -1.1406e+00,
               5.7509e-01, -5.9514e-01],
             [ 1.4892e-01,  6.7530e-01,  3.8891e-01,  ..., -7.7071e-01,
               3.4582e-01,  6.7800e-01]],

            [[ 3.6927e-03,  2.9461e-01,  1.8778e-01,  ..., -8.2912e-01,
               8.4701e-01, -1.3477e+00],
             [-5.2188e-01, -7.1484e-01, -2.3600e-01,  ...,  2.9033e-01,
              -5.5321e-01,  1.6613e-01],
             [-9.0997e-01,  3.8653e-01, -3.3351e-02,  ...,  7.2492e-01,
               6.1858e-01,  1.1354e+00],
             ...,
             [ 8.3440e-02,  1.2616e+00, -1.0419e+00,  ..., -7.4553e-02,
               3.4671e+00, -2.4753e+00],
             [ 1.5947e+00,  4.6897e-01, -4.5872e-01,  ..., -2.6501e-01,
               6.3947e-01,  7.5263e-01],
             [-4.1037e-01, -1.2630e+00,  3.6841e-01,  ...,  5.9369e-01,
               5.1638e-01,  2.2887e+00]]])
    batch_y: [tensor([83, 83, 83, 83]), tensor([1, 1, 1, 1])]
    batch_ind: [tensor([0, 1, 2, 3]), tensor([   0, 1000, 2000, 2600]), tensor([1000, 2000, 3000, 3600])]





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  1.298 seconds)

**Estimated memory usage:**  17 MB


.. _sphx_glr_download_auto_examples_plot_tuh_discrete_multitarget.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_tuh_discrete_multitarget.py <plot_tuh_discrete_multitarget.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_tuh_discrete_multitarget.ipynb <plot_tuh_discrete_multitarget.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
