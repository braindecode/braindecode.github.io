<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Hyperparameter tuning with scikit-learn &mdash; Braindecode 0.6 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-rendered-html.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Process a big data EEG resource (TUH EEG Corpus)" href="plot_tuh_eeg_corpus.html" />
    <link rel="prev" title="Regression example on fake data" href="plot_regression.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Braindecode
          </a>
              <div class="version">
                0.6
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="plot_bcic_iv_2a_moabb_trial.html"> Basic trialwise decoding</a><ul>
<li class="toctree-l2"><a class="reference internal" href="plot_bcic_iv_2a_moabb_trial.html#loading-and-preprocessing-the-dataset">Loading and preprocessing the dataset</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plot_bcic_iv_2a_moabb_trial.html#loading">Loading</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_bcic_iv_2a_moabb_trial.html#preprocessing">Preprocessing</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_bcic_iv_2a_moabb_trial.html#cut-compute-windows">Cut Compute Windows</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_bcic_iv_2a_moabb_trial.html#split-dataset-into-train-and-valid">Split dataset into train and valid</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plot_bcic_iv_2a_moabb_trial.html#create-model">Create model</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_bcic_iv_2a_moabb_trial.html#training">Training</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_bcic_iv_2a_moabb_trial.html#plot-results">Plot Results</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_bcic_iv_2a_moabb_trial.html#plot-confusion-matrix">Plot Confusion Matrix</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="plot_bcic_iv_2a_moabb_cropped.html"> More data-efficient &quot;cropped decoding&quot;</a><ul>
<li class="toctree-l2"><a class="reference internal" href="plot_bcic_iv_2a_moabb_cropped.html#loading-and-preprocessing-the-dataset">Loading and preprocessing the dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_bcic_iv_2a_moabb_cropped.html#create-model-and-compute-windowing-parameters">Create model and compute windowing parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_bcic_iv_2a_moabb_cropped.html#cut-the-data-into-windows">Cut the data into windows</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_bcic_iv_2a_moabb_cropped.html#split-the-dataset">Split the dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_bcic_iv_2a_moabb_cropped.html#training">Training</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_bcic_iv_2a_moabb_cropped.html#plot-results">Plot Results</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_bcic_iv_2a_moabb_cropped.html#plot-confusion-matrix">Plot Confusion Matrix</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="plot_mne_dataset_example.html"> Your own datasets through MNE</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot_custom_dataset_example.html"> Your own datasets through Numpy</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="plot_split_dataset.html">Split Dataset Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_load_save_datasets.html">Load and save dataset example</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_mne_dataset_example.html">MNE Dataset Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_custom_dataset_example.html">Custom Dataset Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_tuh_discrete_multitarget.html">Multiple discrete targets with the TUH EEG Corpus</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_benchmark_preprocessing.html">Benchmarking preprocessing with parallelization and serialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_dataset_example.html">MOABB Dataset Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_regression.html">Regression example on fake data</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Hyperparameter tuning with scikit-learn</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#loading-and-preprocessing-the-dataset">Loading and preprocessing the dataset</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#loading">Loading</a></li>
<li class="toctree-l4"><a class="reference internal" href="#preprocessing">Preprocessing</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cut-compute-windows">Cut Compute Windows</a></li>
<li class="toctree-l4"><a class="reference internal" href="#split-dataset-into-train-and-valid">Split dataset into train and valid</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#create-model">Create model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#training">Training</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plot_tuh_eeg_corpus.html">Process a big data EEG resource (TUH EEG Corpus)</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_sleep_staging_usleep.html">Sleep staging on the Sleep Physionet dataset using U-Sleep network</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plot_sleep_staging_usleep.html#references">References</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_sleep_staging_usleep.html#loading-and-preprocessing-the-dataset">Loading and preprocessing the dataset</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_sleep_staging_usleep.html#loading">Loading</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_sleep_staging_usleep.html#preprocessing">Preprocessing</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_sleep_staging_usleep.html#extract-windows">Extract windows</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_sleep_staging_usleep.html#split-dataset-into-train-and-valid">Split dataset into train and valid</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_sleep_staging_usleep.html#create-sequence-samplers">Create sequence samplers</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_sleep_staging_usleep.html#create-model">Create model</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_sleep_staging_usleep.html#training">Training</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_sleep_staging_usleep.html#plot-results">Plot results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plot_data_augmentation.html">Data Augmentation on BCIC IV 2a Dataset</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plot_data_augmentation.html#loading-and-preprocessing-the-dataset">Loading and preprocessing the dataset</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_data_augmentation.html#loading">Loading</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_data_augmentation.html#preprocessing">Preprocessing</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_data_augmentation.html#extracting-windows">Extracting windows</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_data_augmentation.html#split-dataset-into-train-and-valid">Split dataset into train and valid</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_data_augmentation.html#defining-a-transform">Defining a Transform</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_data_augmentation.html#manipulating-one-session-and-visualizing-the-transformed-data">Manipulating one session and visualizing the transformed data</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_data_augmentation.html#training-a-model-with-data-augmentation">Training a model with data augmentation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_data_augmentation.html#create-model">Create model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_data_augmentation.html#create-an-eegclassifier-with-the-desired-augmentation">Create an EEGClassifier with the desired augmentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_data_augmentation.html#manually-composing-transforms">Manually composing Transforms</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_data_augmentation.html#setting-the-data-augmentation-at-the-dataset-level">Setting the data augmentation at the Dataset level</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plot_sleep_staging_eldele2021.html">Sleep staging on the Sleep Physionet dataset using Eldele2021</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plot_sleep_staging_eldele2021.html#references">References</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_sleep_staging_eldele2021.html#loading-and-preprocessing-the-dataset">Loading and preprocessing the dataset</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_sleep_staging_eldele2021.html#loading">Loading</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_sleep_staging_eldele2021.html#preprocessing">Preprocessing</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_sleep_staging_eldele2021.html#extract-windows">Extract windows</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_sleep_staging_eldele2021.html#window-preprocessing">Window preprocessing</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_sleep_staging_eldele2021.html#split-dataset-into-train-and-valid">Split dataset into train and valid</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_sleep_staging_eldele2021.html#create-sequence-samplers">Create sequence samplers</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_sleep_staging_eldele2021.html#create-model">Create model</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_sleep_staging_eldele2021.html#training">Training</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_sleep_staging_eldele2021.html#plot-results">Plot results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plot_sleep_staging_chambon2018.html">Sleep staging on the Sleep Physionet dataset using Chambon2018 network</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plot_sleep_staging_chambon2018.html#references">References</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_sleep_staging_chambon2018.html#loading-and-preprocessing-the-dataset">Loading and preprocessing the dataset</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_sleep_staging_chambon2018.html#loading">Loading</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_sleep_staging_chambon2018.html#preprocessing">Preprocessing</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_sleep_staging_chambon2018.html#extract-windows">Extract windows</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_sleep_staging_chambon2018.html#window-preprocessing">Window preprocessing</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_sleep_staging_chambon2018.html#split-dataset-into-train-and-valid">Split dataset into train and valid</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_sleep_staging_chambon2018.html#create-sequence-samplers">Create sequence samplers</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_sleep_staging_chambon2018.html#create-model">Create model</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_sleep_staging_chambon2018.html#training">Training</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_sleep_staging_chambon2018.html#plot-results">Plot results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plot_bcic_iv_2a_moabb_trial.html">Trialwise Decoding on BCIC IV 2a Dataset</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plot_bcic_iv_2a_moabb_trial.html#loading-and-preprocessing-the-dataset">Loading and preprocessing the dataset</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_bcic_iv_2a_moabb_trial.html#loading">Loading</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_bcic_iv_2a_moabb_trial.html#preprocessing">Preprocessing</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_bcic_iv_2a_moabb_trial.html#cut-compute-windows">Cut Compute Windows</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_bcic_iv_2a_moabb_trial.html#split-dataset-into-train-and-valid">Split dataset into train and valid</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_bcic_iv_2a_moabb_trial.html#create-model">Create model</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_bcic_iv_2a_moabb_trial.html#training">Training</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_bcic_iv_2a_moabb_trial.html#plot-results">Plot Results</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_bcic_iv_2a_moabb_trial.html#plot-confusion-matrix">Plot Confusion Matrix</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plot_data_augmentation_search.html">Searching the best data augmentation on BCIC IV 2a Dataset</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plot_data_augmentation_search.html#loading-and-preprocessing-the-dataset">Loading and preprocessing the dataset</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_data_augmentation_search.html#loading">Loading</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_data_augmentation_search.html#preprocessing">Preprocessing</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_data_augmentation_search.html#extracting-windows">Extracting windows</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_data_augmentation_search.html#split-dataset-into-train-and-valid">Split dataset into train and valid</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_data_augmentation_search.html#defining-a-list-of-transforms">Defining a list of transforms</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_data_augmentation_search.html#training-a-model-with-data-augmentation">Training a model with data augmentation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_data_augmentation_search.html#create-model">Create model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_data_augmentation_search.html#create-an-eegclassifier-with-the-desired-augmentation">Create an EEGClassifier with the desired augmentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_data_augmentation_search.html#analysing-the-best-fit">Analysing the best fit</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plot_bcic_iv_2a_moabb_cropped.html">Cropped Decoding on BCIC IV 2a Dataset</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plot_bcic_iv_2a_moabb_cropped.html#loading-and-preprocessing-the-dataset">Loading and preprocessing the dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_bcic_iv_2a_moabb_cropped.html#create-model-and-compute-windowing-parameters">Create model and compute windowing parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_bcic_iv_2a_moabb_cropped.html#cut-the-data-into-windows">Cut the data into windows</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_bcic_iv_2a_moabb_cropped.html#split-the-dataset">Split the dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_bcic_iv_2a_moabb_cropped.html#training">Training</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_bcic_iv_2a_moabb_cropped.html#plot-results">Plot Results</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_bcic_iv_2a_moabb_cropped.html#plot-confusion-matrix">Plot Confusion Matrix</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plot_bcic_iv_4_ecog_trial.html">Fingers flexion decoding on BCIC IV 4 ECoG Dataset</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plot_bcic_iv_4_ecog_trial.html#loading-and-preparing-the-dataset">Loading and preparing the dataset</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_bcic_iv_4_ecog_trial.html#loading">Loading</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_bcic_iv_4_ecog_trial.html#preprocessing">Preprocessing</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_bcic_iv_4_ecog_trial.html#cut-compute-windows">Cut Compute Windows</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_bcic_iv_4_ecog_trial.html#split-dataset-into-train-valid-and-test">Split dataset into train, valid, and test</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_bcic_iv_4_ecog_trial.html#create-model">Create model</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_bcic_iv_4_ecog_trial.html#training">Training</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_bcic_iv_4_ecog_trial.html#plot-results">Plot Results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="benchmark_lazy_eager_loading.html">Benchmarking eager and lazy loading</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_bcic_iv_4_ecog_cropped.html">Fingers flexion cropped decoding on BCIC IV 4 ECoG Dataset</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plot_bcic_iv_4_ecog_cropped.html#loading-and-preparing-the-dataset">Loading and preparing the dataset</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_bcic_iv_4_ecog_cropped.html#loading">Loading</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_bcic_iv_4_ecog_cropped.html#split-dataset-into-train-and-test">Split dataset into train and test</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_bcic_iv_4_ecog_cropped.html#preprocessing">Preprocessing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_bcic_iv_4_ecog_cropped.html#create-model">Create model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_bcic_iv_4_ecog_cropped.html#cut-compute-windows">Cut Compute Windows</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_bcic_iv_4_ecog_cropped.html#training">Training</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_bcic_iv_4_ecog_cropped.html#plot-results">Plot Results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plot_relative_positioning.html">Self-supervised learning on EEG with relative positioning</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plot_relative_positioning.html#loading-and-preprocessing-the-dataset">Loading and preprocessing the dataset</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_relative_positioning.html#loading-the-raw-recordings">Loading the raw recordings</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_relative_positioning.html#preprocessing">Preprocessing</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_relative_positioning.html#extracting-windows">Extracting windows</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_relative_positioning.html#preprocessing-windows">Preprocessing windows</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_relative_positioning.html#splitting-dataset-into-train-valid-and-test-sets">Splitting dataset into train, valid and test sets</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_relative_positioning.html#creating-samplers">Creating samplers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_relative_positioning.html#creating-the-model">Creating the model</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_relative_positioning.html#training">Training</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_relative_positioning.html#visualizing-the-results">Visualizing the results</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_relative_positioning.html#inspecting-pretext-task-performance">Inspecting pretext task performance</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_relative_positioning.html#using-the-learned-representation-for-sleep-staging">Using the learned representation for sleep staging</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_relative_positioning.html#conclusion">Conclusion</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_relative_positioning.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api.html#classifier">Classifier</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.classifier.EEGClassifier.html">braindecode.classifier.EEGClassifier</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#regressor">Regressor</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.regressor.EEGRegressor.html">braindecode.regressor.EEGRegressor</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#models">Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.models.ShallowFBCSPNet.html">braindecode.models.ShallowFBCSPNet</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/braindecode.models.ShallowFBCSPNet.html#examples-using-braindecode-models-shallowfbcspnet">Examples using <code class="docutils literal notranslate"><span class="pre">braindecode.models.ShallowFBCSPNet</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.models.Deep4Net.html">braindecode.models.Deep4Net</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/braindecode.models.Deep4Net.html#examples-using-braindecode-models-deep4net">Examples using <code class="docutils literal notranslate"><span class="pre">braindecode.models.Deep4Net</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.models.EEGNetv1.html">braindecode.models.EEGNetv1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.models.EEGNetv4.html">braindecode.models.EEGNetv4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.models.HybridNet.html">braindecode.models.HybridNet</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.models.EEGResNet.html">braindecode.models.EEGResNet</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.models.TCN.html">braindecode.models.TCN</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.models.SleepStagerChambon2018.html">braindecode.models.SleepStagerChambon2018</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/braindecode.models.SleepStagerChambon2018.html#examples-using-braindecode-models-sleepstagerchambon2018">Examples using <code class="docutils literal notranslate"><span class="pre">braindecode.models.SleepStagerChambon2018</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.models.SleepStagerBlanco2020.html">braindecode.models.SleepStagerBlanco2020</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.models.SleepStagerEldele2021.html">braindecode.models.SleepStagerEldele2021</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/braindecode.models.SleepStagerEldele2021.html#examples-using-braindecode-models-sleepstagereldele2021">Examples using <code class="docutils literal notranslate"><span class="pre">braindecode.models.SleepStagerEldele2021</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.models.USleep.html">braindecode.models.USleep</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/braindecode.models.USleep.html#examples-using-braindecode-models-usleep">Examples using <code class="docutils literal notranslate"><span class="pre">braindecode.models.USleep</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.models.TIDNet.html">braindecode.models.TIDNet</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.models.get_output_shape.html">braindecode.models.get_output_shape</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/braindecode.models.get_output_shape.html#examples-using-braindecode-models-get-output-shape">Examples using <code class="docutils literal notranslate"><span class="pre">braindecode.models.get_output_shape</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.models.TimeDistributed.html">braindecode.models.TimeDistributed</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/braindecode.models.TimeDistributed.html#examples-using-braindecode-models-timedistributed">Examples using <code class="docutils literal notranslate"><span class="pre">braindecode.models.TimeDistributed</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#training">Training</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.training.CroppedLoss.html">braindecode.training.CroppedLoss</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/braindecode.training.CroppedLoss.html#examples-using-braindecode-training-croppedloss">Examples using <code class="docutils literal notranslate"><span class="pre">braindecode.training.CroppedLoss</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.training.TimeSeriesLoss.html">braindecode.training.TimeSeriesLoss</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/braindecode.training.TimeSeriesLoss.html#examples-using-braindecode-training-timeseriesloss">Examples using <code class="docutils literal notranslate"><span class="pre">braindecode.training.TimeSeriesLoss</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.training.CroppedTrialEpochScoring.html">braindecode.training.CroppedTrialEpochScoring</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/braindecode.training.CroppedTrialEpochScoring.html#examples-using-braindecode-training-croppedtrialepochscoring">Examples using <code class="docutils literal notranslate"><span class="pre">braindecode.training.CroppedTrialEpochScoring</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.training.CroppedTimeSeriesEpochScoring.html">braindecode.training.CroppedTimeSeriesEpochScoring</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/braindecode.training.CroppedTimeSeriesEpochScoring.html#examples-using-braindecode-training-croppedtimeseriesepochscoring">Examples using <code class="docutils literal notranslate"><span class="pre">braindecode.training.CroppedTimeSeriesEpochScoring</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.training.PostEpochTrainScoring.html">braindecode.training.PostEpochTrainScoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.training.mixup_criterion.html">braindecode.training.mixup_criterion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.training.trial_preds_from_window_preds.html">braindecode.training.trial_preds_from_window_preds</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.training.predict_trials.html">braindecode.training.predict_trials</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#datasets">Datasets</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.datasets.BaseDataset.html">braindecode.datasets.BaseDataset</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/braindecode.datasets.BaseDataset.html#examples-using-braindecode-datasets-basedataset">Examples using <code class="docutils literal notranslate"><span class="pre">braindecode.datasets.BaseDataset</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.datasets.BaseConcatDataset.html">braindecode.datasets.BaseConcatDataset</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/braindecode.datasets.BaseConcatDataset.html#examples-using-braindecode-datasets-baseconcatdataset">Examples using <code class="docutils literal notranslate"><span class="pre">braindecode.datasets.BaseConcatDataset</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.datasets.WindowsDataset.html">braindecode.datasets.WindowsDataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.datasets.MOABBDataset.html">braindecode.datasets.MOABBDataset</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/braindecode.datasets.MOABBDataset.html#examples-using-braindecode-datasets-moabbdataset">Examples using <code class="docutils literal notranslate"><span class="pre">braindecode.datasets.MOABBDataset</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.datasets.HGD.html">braindecode.datasets.HGD</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.datasets.BNCI2014001.html">braindecode.datasets.BNCI2014001</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.datasets.TUH.html">braindecode.datasets.TUH</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/braindecode.datasets.TUH.html#examples-using-braindecode-datasets-tuh">Examples using <code class="docutils literal notranslate"><span class="pre">braindecode.datasets.TUH</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.datasets.TUHAbnormal.html">braindecode.datasets.TUHAbnormal</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/braindecode.datasets.TUHAbnormal.html#examples-using-braindecode-datasets-tuhabnormal">Examples using <code class="docutils literal notranslate"><span class="pre">braindecode.datasets.TUHAbnormal</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.datasets.SleepPhysionet.html">braindecode.datasets.SleepPhysionet</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/braindecode.datasets.SleepPhysionet.html#examples-using-braindecode-datasets-sleepphysionet">Examples using <code class="docutils literal notranslate"><span class="pre">braindecode.datasets.SleepPhysionet</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.datasets.BCICompetitionIVDataset4.html">braindecode.datasets.BCICompetitionIVDataset4</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/braindecode.datasets.BCICompetitionIVDataset4.html#examples-using-braindecode-datasets-bcicompetitionivdataset4">Examples using <code class="docutils literal notranslate"><span class="pre">braindecode.datasets.BCICompetitionIVDataset4</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.datasets.create_from_X_y.html">braindecode.datasets.create_from_X_y</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/braindecode.datasets.create_from_X_y.html#examples-using-braindecode-datasets-create-from-x-y">Examples using <code class="docutils literal notranslate"><span class="pre">braindecode.datasets.create_from_X_y</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.datasets.create_from_mne_raw.html">braindecode.datasets.create_from_mne_raw</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/braindecode.datasets.create_from_mne_raw.html#examples-using-braindecode-datasets-create-from-mne-raw">Examples using <code class="docutils literal notranslate"><span class="pre">braindecode.datasets.create_from_mne_raw</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.datasets.create_from_mne_epochs.html">braindecode.datasets.create_from_mne_epochs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/braindecode.datasets.create_from_mne_epochs.html#examples-using-braindecode-datasets-create-from-mne-epochs">Examples using <code class="docutils literal notranslate"><span class="pre">braindecode.datasets.create_from_mne_epochs</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#preprocessing">Preprocessing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.preprocessing.create_windows_from_events.html">braindecode.preprocessing.create_windows_from_events</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/braindecode.preprocessing.create_windows_from_events.html#examples-using-braindecode-preprocessing-create-windows-from-events">Examples using <code class="docutils literal notranslate"><span class="pre">braindecode.preprocessing.create_windows_from_events</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.preprocessing.create_fixed_length_windows.html">braindecode.preprocessing.create_fixed_length_windows</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/braindecode.preprocessing.create_fixed_length_windows.html#examples-using-braindecode-preprocessing-create-fixed-length-windows">Examples using <code class="docutils literal notranslate"><span class="pre">braindecode.preprocessing.create_fixed_length_windows</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.preprocessing.create_windows_from_target_channels.html">braindecode.preprocessing.create_windows_from_target_channels</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/braindecode.preprocessing.create_windows_from_target_channels.html#examples-using-braindecode-preprocessing-create-windows-from-target-channels">Examples using <code class="docutils literal notranslate"><span class="pre">braindecode.preprocessing.create_windows_from_target_channels</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.preprocessing.exponential_moving_demean.html">braindecode.preprocessing.exponential_moving_demean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.preprocessing.exponential_moving_standardize.html">braindecode.preprocessing.exponential_moving_standardize</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/braindecode.preprocessing.exponential_moving_standardize.html#examples-using-braindecode-preprocessing-exponential-moving-standardize">Examples using <code class="docutils literal notranslate"><span class="pre">braindecode.preprocessing.exponential_moving_standardize</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.preprocessing.zscore.html">braindecode.preprocessing.zscore</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.preprocessing.scale.html">braindecode.preprocessing.scale</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/braindecode.preprocessing.scale.html#examples-using-braindecode-preprocessing-scale">Examples using <code class="docutils literal notranslate"><span class="pre">braindecode.preprocessing.scale</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.preprocessing.filterbank.html">braindecode.preprocessing.filterbank</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.preprocessing.preprocess.html">braindecode.preprocessing.preprocess</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/braindecode.preprocessing.preprocess.html#examples-using-braindecode-preprocessing-preprocess">Examples using <code class="docutils literal notranslate"><span class="pre">braindecode.preprocessing.preprocess</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.preprocessing.Preprocessor.html">braindecode.preprocessing.Preprocessor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/braindecode.preprocessing.Preprocessor.html#examples-using-braindecode-preprocessing-preprocessor">Examples using <code class="docutils literal notranslate"><span class="pre">braindecode.preprocessing.Preprocessor</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#data-utils">Data Utils</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.datautil.save_concat_dataset.html">braindecode.datautil.save_concat_dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.datautil.load_concat_dataset.html">braindecode.datautil.load_concat_dataset</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/braindecode.datautil.load_concat_dataset.html#examples-using-braindecode-datautil-load-concat-dataset">Examples using <code class="docutils literal notranslate"><span class="pre">braindecode.datautil.load_concat_dataset</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#samplers">Samplers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.samplers.RecordingSampler.html">braindecode.samplers.RecordingSampler</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/braindecode.samplers.RecordingSampler.html#examples-using-braindecode-samplers-recordingsampler">Examples using <code class="docutils literal notranslate"><span class="pre">braindecode.samplers.RecordingSampler</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.samplers.SequenceSampler.html">braindecode.samplers.SequenceSampler</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/braindecode.samplers.SequenceSampler.html#examples-using-braindecode-samplers-sequencesampler">Examples using <code class="docutils literal notranslate"><span class="pre">braindecode.samplers.SequenceSampler</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.samplers.RelativePositioningSampler.html">braindecode.samplers.RelativePositioningSampler</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/braindecode.samplers.RelativePositioningSampler.html#examples-using-braindecode-samplers-relativepositioningsampler">Examples using <code class="docutils literal notranslate"><span class="pre">braindecode.samplers.RelativePositioningSampler</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.samplers.BalancedSequenceSampler.html">braindecode.samplers.BalancedSequenceSampler</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#augmentation">Augmentation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.augmentation.Transform.html">braindecode.augmentation.Transform</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/braindecode.augmentation.Transform.html#examples-using-braindecode-augmentation-transform">Examples using <code class="docutils literal notranslate"><span class="pre">braindecode.augmentation.Transform</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.augmentation.IdentityTransform.html">braindecode.augmentation.IdentityTransform</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.augmentation.Compose.html">braindecode.augmentation.Compose</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/braindecode.augmentation.Compose.html#examples-using-braindecode-augmentation-compose">Examples using <code class="docutils literal notranslate"><span class="pre">braindecode.augmentation.Compose</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.augmentation.AugmentedDataLoader.html">braindecode.augmentation.AugmentedDataLoader</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/braindecode.augmentation.AugmentedDataLoader.html#examples-using-braindecode-augmentation-augmenteddataloader">Examples using <code class="docutils literal notranslate"><span class="pre">braindecode.augmentation.AugmentedDataLoader</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.augmentation.TimeReverse.html">braindecode.augmentation.TimeReverse</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.augmentation.SignFlip.html">braindecode.augmentation.SignFlip</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/braindecode.augmentation.SignFlip.html#examples-using-braindecode-augmentation-signflip">Examples using <code class="docutils literal notranslate"><span class="pre">braindecode.augmentation.SignFlip</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.augmentation.FTSurrogate.html">braindecode.augmentation.FTSurrogate</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/braindecode.augmentation.FTSurrogate.html#examples-using-braindecode-augmentation-ftsurrogate">Examples using <code class="docutils literal notranslate"><span class="pre">braindecode.augmentation.FTSurrogate</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.augmentation.ChannelsShuffle.html">braindecode.augmentation.ChannelsShuffle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.augmentation.ChannelsDropout.html">braindecode.augmentation.ChannelsDropout</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/braindecode.augmentation.ChannelsDropout.html#examples-using-braindecode-augmentation-channelsdropout">Examples using <code class="docutils literal notranslate"><span class="pre">braindecode.augmentation.ChannelsDropout</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.augmentation.GaussianNoise.html">braindecode.augmentation.GaussianNoise</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.augmentation.ChannelsSymmetry.html">braindecode.augmentation.ChannelsSymmetry</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.augmentation.SmoothTimeMask.html">braindecode.augmentation.SmoothTimeMask</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/braindecode.augmentation.SmoothTimeMask.html#examples-using-braindecode-augmentation-smoothtimemask">Examples using <code class="docutils literal notranslate"><span class="pre">braindecode.augmentation.SmoothTimeMask</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.augmentation.BandstopFilter.html">braindecode.augmentation.BandstopFilter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.augmentation.FrequencyShift.html">braindecode.augmentation.FrequencyShift</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/braindecode.augmentation.FrequencyShift.html#examples-using-braindecode-augmentation-frequencyshift">Examples using <code class="docutils literal notranslate"><span class="pre">braindecode.augmentation.FrequencyShift</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.augmentation.SensorsRotation.html">braindecode.augmentation.SensorsRotation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.augmentation.SensorsZRotation.html">braindecode.augmentation.SensorsZRotation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.augmentation.SensorsYRotation.html">braindecode.augmentation.SensorsYRotation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.augmentation.SensorsXRotation.html">braindecode.augmentation.SensorsXRotation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.augmentation.Mixup.html">braindecode.augmentation.Mixup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.augmentation.functional.identity.html">braindecode.augmentation.functional.identity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.augmentation.functional.time_reverse.html">braindecode.augmentation.functional.time_reverse</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.augmentation.functional.sign_flip.html">braindecode.augmentation.functional.sign_flip</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.augmentation.functional.ft_surrogate.html">braindecode.augmentation.functional.ft_surrogate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.augmentation.functional.channels_dropout.html">braindecode.augmentation.functional.channels_dropout</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.augmentation.functional.channels_shuffle.html">braindecode.augmentation.functional.channels_shuffle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.augmentation.functional.channels_permute.html">braindecode.augmentation.functional.channels_permute</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.augmentation.functional.gaussian_noise.html">braindecode.augmentation.functional.gaussian_noise</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.augmentation.functional.smooth_time_mask.html">braindecode.augmentation.functional.smooth_time_mask</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.augmentation.functional.bandstop_filter.html">braindecode.augmentation.functional.bandstop_filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.augmentation.functional.frequency_shift.html">braindecode.augmentation.functional.frequency_shift</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.augmentation.functional.sensors_rotation.html">braindecode.augmentation.functional.sensors_rotation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.augmentation.functional.mixup.html">braindecode.augmentation.functional.mixup</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#utils">Utils</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.util.set_random_seeds.html">braindecode.util.set_random_seeds</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/braindecode.util.set_random_seeds.html#examples-using-braindecode-util-set-random-seeds">Examples using <code class="docutils literal notranslate"><span class="pre">braindecode.util.set_random_seeds</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#visualization">Visualization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.visualization.compute_amplitude_gradients.html">braindecode.visualization.compute_amplitude_gradients</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/braindecode.visualization.plot_confusion_matrix.html">braindecode.visualization.plot_confusion_matrix</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/braindecode.visualization.plot_confusion_matrix.html#examples-using-braindecode-visualization-plot-confusion-matrix">Examples using <code class="docutils literal notranslate"><span class="pre">braindecode.visualization.plot_confusion_matrix</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../whats_new.html">What’s new</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../whats_new.html#current-0-7-dev0">Current (0.7.dev0)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../whats_new.html#enhancements">Enhancements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../whats_new.html#bugs">Bugs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../whats_new.html#api-changes">API changes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../whats_new.html#version-0-6-2021-12-06">Version 0.6 (2021-12-06)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../whats_new.html#id1">Enhancements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../whats_new.html#id2">Bugs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../whats_new.html#id3">API changes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../whats_new.html#version-0-5-1-2021-07-14">Version 0.5.1 (2021-07-14)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../whats_new.html#id4">Enhancements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../whats_new.html#id5">Bugs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../whats_new.html#id6">API changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../whats_new.html#authors">Authors</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Braindecode</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">Examples</a> &raquo;</li>
      <li>Hyperparameter tuning with scikit-learn</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/auto_examples/plot_hyperparameter_tuning_with_scikit-learn.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-plot-hyperparameter-tuning-with-scikit-learn-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="hyperparameter-tuning-with-scikit-learn">
<span id="sphx-glr-auto-examples-plot-hyperparameter-tuning-with-scikit-learn-py"></span><h1>Hyperparameter tuning with scikit-learn<a class="headerlink" href="#hyperparameter-tuning-with-scikit-learn" title="Permalink to this heading">¶</a></h1>
<p>This tutorial shows you how to tune hyperparameters with scikit-learn
(GridSearchCV) in the setting of trialwise decoding on dataset
BCIC IV 2a.</p>
<section id="loading-and-preprocessing-the-dataset">
<h2>Loading and preprocessing the dataset<a class="headerlink" href="#loading-and-preprocessing-the-dataset" title="Permalink to this heading">¶</a></h2>
<section id="loading">
<h3>Loading<a class="headerlink" href="#loading" title="Permalink to this heading">¶</a></h3>
<p>First, we load the data. In this tutorial, we use the functionality of
braindecode to load datasets through
<a class="reference external" href="https://github.com/NeuroTechX/moabb">MOABB</a> to load the BCI
Competition IV 2a data.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To load your own datasets either via mne or from
preprocessed X/y numpy arrays, see <a class="reference external" href="./plot_mne_dataset_example.html">MNE Dataset
Tutorial</a> and <a class="reference external" href="./plot_custom_dataset_example.html">Numpy Dataset
Tutorial</a>.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">braindecode.datasets.moabb</span> <span class="kn">import</span> <a href="../generated/braindecode.datasets.MOABBDataset.html#braindecode.datasets.MOABBDataset" title="braindecode.datasets.MOABBDataset" class="sphx-glr-backref-module-braindecode-datasets sphx-glr-backref-type-py-class"><span class="n">MOABBDataset</span></a>

<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subject_id</span></a> <span class="o">=</span> <span class="mi">3</span>
<a href="../generated/braindecode.datasets.MOABBDataset.html#braindecode.datasets.MOABBDataset" title="braindecode.datasets.MOABBDataset" class="sphx-glr-backref-module-braindecode-datasets sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span></a> <span class="o">=</span> <a href="../generated/braindecode.datasets.MOABBDataset.html#braindecode.datasets.MOABBDataset" title="braindecode.datasets.MOABBDataset" class="sphx-glr-backref-module-braindecode-datasets sphx-glr-backref-type-py-class"><span class="n">MOABBDataset</span></a><span class="p">(</span><span class="n">dataset_name</span><span class="o">=</span><span class="s2">&quot;BNCI2014001&quot;</span><span class="p">,</span> <span class="n">subject_ids</span><span class="o">=</span><span class="p">[</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subject_id</span></a><span class="p">])</span>
</pre></div>
</div>
</section>
<section id="preprocessing">
<h3>Preprocessing<a class="headerlink" href="#preprocessing" title="Permalink to this heading">¶</a></h3>
<p>Now we apply preprocessing like bandpass filtering to our dataset. You
can either apply functions provided by
<a class="reference external" href="https://mne.tools/stable/generated/mne.io.Raw.html">mne.Raw</a> or
<a class="reference external" href="https://mne.tools/0.11/generated/mne.Epochs.html#mne.Epochs">mne.Epochs</a>
or apply your own functions, either to the MNE object or the underlying
numpy array.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These prepocessings are now directly applied to the loaded
data, and not on-the-fly applied as transformations in
PyTorch-libraries like
<a class="reference external" href="https://pytorch.org/docs/stable/torchvision/index.html">torchvision</a>.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">braindecode.preprocessing.preprocess</span> <span class="kn">import</span> <span class="p">(</span>
    <a href="../generated/braindecode.preprocessing.exponential_moving_standardize.html#braindecode.preprocessing.exponential_moving_standardize" title="braindecode.preprocessing.exponential_moving_standardize" class="sphx-glr-backref-module-braindecode-preprocessing sphx-glr-backref-type-py-function"><span class="n">exponential_moving_standardize</span></a><span class="p">,</span> <a href="../generated/braindecode.preprocessing.preprocess.html#braindecode.preprocessing.preprocess" title="braindecode.preprocessing.preprocess" class="sphx-glr-backref-module-braindecode-preprocessing sphx-glr-backref-type-py-function"><span class="n">preprocess</span></a><span class="p">,</span> <a href="../generated/braindecode.preprocessing.Preprocessor.html#braindecode.preprocessing.Preprocessor" title="braindecode.preprocessing.Preprocessor" class="sphx-glr-backref-module-braindecode-preprocessing sphx-glr-backref-type-py-class"><span class="n">Preprocessor</span></a><span class="p">,</span> <a href="../generated/braindecode.preprocessing.scale.html#braindecode.preprocessing.scale" title="braindecode.preprocessing.scale" class="sphx-glr-backref-module-braindecode-preprocessing sphx-glr-backref-type-py-function"><span class="n">scale</span></a><span class="p">)</span>

<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">low_cut_hz</span></a> <span class="o">=</span> <span class="mf">4.</span>  <span class="c1"># low cut frequency for filtering</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">high_cut_hz</span></a> <span class="o">=</span> <span class="mf">38.</span>  <span class="c1"># high cut frequency for filtering</span>
<span class="c1"># Parameters for exponential moving standardization</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">factor_new</span></a> <span class="o">=</span> <span class="mf">1e-3</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">init_block_size</span></a> <span class="o">=</span> <span class="mi">1000</span>

<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">preprocessors</span></a> <span class="o">=</span> <span class="p">[</span>
    <a href="../generated/braindecode.preprocessing.Preprocessor.html#braindecode.preprocessing.Preprocessor" title="braindecode.preprocessing.Preprocessor" class="sphx-glr-backref-module-braindecode-preprocessing sphx-glr-backref-type-py-class"><span class="n">Preprocessor</span></a><span class="p">(</span><span class="s1">&#39;pick_types&#39;</span><span class="p">,</span> <span class="n">eeg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">meg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">stim</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>  <span class="c1"># Keep EEG sensors</span>
    <a href="../generated/braindecode.preprocessing.Preprocessor.html#braindecode.preprocessing.Preprocessor" title="braindecode.preprocessing.Preprocessor" class="sphx-glr-backref-module-braindecode-preprocessing sphx-glr-backref-type-py-class"><span class="n">Preprocessor</span></a><span class="p">(</span><a href="../generated/braindecode.preprocessing.scale.html#braindecode.preprocessing.scale" title="braindecode.preprocessing.scale" class="sphx-glr-backref-module-braindecode-preprocessing sphx-glr-backref-type-py-function"><span class="n">scale</span></a><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">apply_on_array</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>  <span class="c1"># Convert from V to uV</span>
    <a href="../generated/braindecode.preprocessing.Preprocessor.html#braindecode.preprocessing.Preprocessor" title="braindecode.preprocessing.Preprocessor" class="sphx-glr-backref-module-braindecode-preprocessing sphx-glr-backref-type-py-class"><span class="n">Preprocessor</span></a><span class="p">(</span><span class="s1">&#39;filter&#39;</span><span class="p">,</span> <span class="n">l_freq</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">low_cut_hz</span></a><span class="p">,</span> <span class="n">h_freq</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">high_cut_hz</span></a><span class="p">),</span>  <span class="c1"># Bandpass filter</span>
    <a href="../generated/braindecode.preprocessing.Preprocessor.html#braindecode.preprocessing.Preprocessor" title="braindecode.preprocessing.Preprocessor" class="sphx-glr-backref-module-braindecode-preprocessing sphx-glr-backref-type-py-class"><span class="n">Preprocessor</span></a><span class="p">(</span><a href="../generated/braindecode.preprocessing.exponential_moving_standardize.html#braindecode.preprocessing.exponential_moving_standardize" title="braindecode.preprocessing.exponential_moving_standardize" class="sphx-glr-backref-module-braindecode-preprocessing sphx-glr-backref-type-py-function"><span class="n">exponential_moving_standardize</span></a><span class="p">,</span>  <span class="c1"># Exponential moving standardization</span>
                 <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">factor_new</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">factor_new</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">init_block_size</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">init_block_size</span></a><span class="p">)</span>
<span class="p">]</span>

<span class="c1"># Transform the data</span>
<a href="../generated/braindecode.preprocessing.preprocess.html#braindecode.preprocessing.preprocess" title="braindecode.preprocessing.preprocess" class="sphx-glr-backref-module-braindecode-preprocessing sphx-glr-backref-type-py-function"><span class="n">preprocess</span></a><span class="p">(</span><a href="../generated/braindecode.datasets.MOABBDataset.html#braindecode.datasets.MOABBDataset" title="braindecode.datasets.MOABBDataset" class="sphx-glr-backref-module-braindecode-datasets sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">preprocessors</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/usr/share/miniconda/envs/braindecode/lib/python3.7/site-packages/sklearn/utils/deprecation.py:87: FutureWarning: Function scale is deprecated; will be removed in 0.7.0. Use numpy.multiply instead.
  warnings.warn(msg, category=FutureWarning)

&lt;braindecode.datasets.moabb.MOABBDataset object at 0x7f2c5a3f5510&gt;
</pre></div>
</div>
</section>
<section id="cut-compute-windows">
<h3>Cut Compute Windows<a class="headerlink" href="#cut-compute-windows" title="Permalink to this heading">¶</a></h3>
<p>Now we cut out compute windows, the inputs for the deep networks during
training. In the case of trialwise decoding, we just have to decide if
we want to cut out some part before and/or after the trial. For this
dataset, in our work, it often was beneficial to also cut out 500 ms
before the trial.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">braindecode.preprocessing.windowers</span> <span class="kn">import</span> <a href="../generated/braindecode.preprocessing.create_windows_from_events.html#braindecode.preprocessing.create_windows_from_events" title="braindecode.preprocessing.create_windows_from_events" class="sphx-glr-backref-module-braindecode-preprocessing sphx-glr-backref-type-py-function"><span class="n">create_windows_from_events</span></a>

<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trial_start_offset_seconds</span></a> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span>
<span class="c1"># Extract sampling frequency, check that they are same in all datasets</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sfreq</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span><span class="o">.</span><span class="n">datasets</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;sfreq&#39;</span><span class="p">]</span>
<span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="n">ds</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;sfreq&#39;</span><span class="p">]</span> <span class="o">==</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sfreq</span></a> <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span><span class="o">.</span><span class="n">datasets</span></a><span class="p">])</span>
<span class="c1"># Calculate the trial start offset in samples.</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trial_start_offset_samples</span></a> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trial_start_offset_seconds</span></a> <span class="o">*</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sfreq</span></a><span class="p">)</span>

<span class="c1"># Create windows using braindecode function for this. It needs parameters to define how</span>
<span class="c1"># trials should be used.</span>
<a href="../generated/braindecode.datasets.BaseConcatDataset.html#braindecode.datasets.BaseConcatDataset" title="braindecode.datasets.BaseConcatDataset" class="sphx-glr-backref-module-braindecode-datasets sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">windows_dataset</span></a> <span class="o">=</span> <a href="../generated/braindecode.preprocessing.create_windows_from_events.html#braindecode.preprocessing.create_windows_from_events" title="braindecode.preprocessing.create_windows_from_events" class="sphx-glr-backref-module-braindecode-preprocessing sphx-glr-backref-type-py-function"><span class="n">create_windows_from_events</span></a><span class="p">(</span>
    <a href="../generated/braindecode.datasets.MOABBDataset.html#braindecode.datasets.MOABBDataset" title="braindecode.datasets.MOABBDataset" class="sphx-glr-backref-module-braindecode-datasets sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trial_start_offset_samples</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trial_start_offset_samples</span></a><span class="p">,</span>
    <span class="n">trial_stop_offset_samples</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="split-dataset-into-train-and-valid">
<h3>Split dataset into train and valid<a class="headerlink" href="#split-dataset-into-train-and-valid" title="Permalink to this heading">¶</a></h3>
<p>We can easily split the dataset using additional info stored in the
description attribute, in this case <code class="docutils literal notranslate"><span class="pre">session</span></code> column. We select
<code class="docutils literal notranslate"><span class="pre">session_T</span></code> for training and <code class="docutils literal notranslate"><span class="pre">session_E</span></code> for evaluation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">splitted</span></a> <span class="o">=</span> <a href="../generated/braindecode.datasets.BaseConcatDataset.html#braindecode.datasets.BaseConcatDataset.split" title="braindecode.datasets.BaseConcatDataset.split" class="sphx-glr-backref-module-braindecode-datasets sphx-glr-backref-type-py-method"><span class="n">windows_dataset</span><span class="o">.</span><span class="n">split</span></a><span class="p">(</span><span class="s1">&#39;session&#39;</span><span class="p">)</span>
<a href="../generated/braindecode.datasets.BaseConcatDataset.html#braindecode.datasets.BaseConcatDataset" title="braindecode.datasets.BaseConcatDataset" class="sphx-glr-backref-module-braindecode-datasets sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">train_set</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">splitted</span></a><span class="p">[</span><span class="s1">&#39;session_T&#39;</span><span class="p">]</span>
<a href="../generated/braindecode.datasets.BaseConcatDataset.html#braindecode.datasets.BaseConcatDataset" title="braindecode.datasets.BaseConcatDataset" class="sphx-glr-backref-module-braindecode-datasets sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">eval_set</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">splitted</span></a><span class="p">[</span><span class="s1">&#39;session_E&#39;</span><span class="p">]</span>
</pre></div>
</div>
</section>
</section>
<section id="create-model">
<h2>Create model<a class="headerlink" href="#create-model" title="Permalink to this heading">¶</a></h2>
<p>Now we create the deep learning model! Braindecode comes with some
predefined convolutional neural network architectures for raw
time-domain EEG. Here, we use the shallow ConvNet model from <a class="reference external" href="https://arxiv.org/abs/1703.05051">Deep
learning with convolutional neural networks for EEG decoding and
visualization</a>. These models are
pure <a class="reference external" href="https://pytorch.org">PyTorch</a> deep learning models, therefore
to use your own model, it just has to be a normal PyTorch
<a class="reference external" href="https://pytorch.org/docs/stable/nn.html#torch.nn.Module">nn.Module</a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">braindecode.util</span> <span class="kn">import</span> <a href="../generated/braindecode.util.set_random_seeds.html#braindecode.util.set_random_seeds" title="braindecode.util.set_random_seeds" class="sphx-glr-backref-module-braindecode-util sphx-glr-backref-type-py-function"><span class="n">set_random_seeds</span></a>
<span class="kn">from</span> <span class="nn">braindecode.models</span> <span class="kn">import</span> <a href="../generated/braindecode.models.ShallowFBCSPNet.html#braindecode.models.ShallowFBCSPNet" title="braindecode.models.ShallowFBCSPNet" class="sphx-glr-backref-module-braindecode-models sphx-glr-backref-type-py-class"><span class="n">ShallowFBCSPNet</span></a>

<a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cuda</span></a> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cuda</span></a><span class="o">.</span><span class="n">is_available</span><span class="p">()</span>  <span class="c1"># check if GPU is available, if True chooses to use it</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">device</span></a> <span class="o">=</span> <span class="s1">&#39;cuda&#39;</span> <span class="k">if</span> <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cuda</span></a> <span class="k">else</span> <span class="s1">&#39;cpu&#39;</span>
<span class="k">if</span> <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cuda</span></a><span class="p">:</span>
    <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">torch</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">cudnn</span><span class="o">.</span><span class="n">benchmark</span></a> <span class="o">=</span> <span class="kc">True</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">seed</span></a> <span class="o">=</span> <span class="mi">20200220</span>  <span class="c1"># random seed to make results reproducible</span>
<span class="c1"># Set random seed to be able to reproduce results</span>
<a href="../generated/braindecode.util.set_random_seeds.html#braindecode.util.set_random_seeds" title="braindecode.util.set_random_seeds" class="sphx-glr-backref-module-braindecode-util sphx-glr-backref-type-py-function"><span class="n">set_random_seeds</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">seed</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">seed</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cuda</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cuda</span></a><span class="p">)</span>

<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_classes</span></a> <span class="o">=</span> <span class="mi">4</span>
<span class="c1"># Extract number of chans and time steps from dataset</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_chans</span></a> <span class="o">=</span> <a href="../generated/braindecode.datasets.BaseConcatDataset.html#braindecode.datasets.BaseConcatDataset" title="braindecode.datasets.BaseConcatDataset" class="sphx-glr-backref-module-braindecode-datasets sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">train_set</span></a><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">input_window_samples</span></a> <span class="o">=</span> <a href="../generated/braindecode.datasets.BaseConcatDataset.html#braindecode.datasets.BaseConcatDataset" title="braindecode.datasets.BaseConcatDataset" class="sphx-glr-backref-module-braindecode-datasets sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">train_set</span></a><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<a href="../generated/braindecode.models.ShallowFBCSPNet.html#braindecode.models.ShallowFBCSPNet" title="braindecode.models.ShallowFBCSPNet" class="sphx-glr-backref-module-braindecode-models sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">model</span></a> <span class="o">=</span> <a href="../generated/braindecode.models.ShallowFBCSPNet.html#braindecode.models.ShallowFBCSPNet" title="braindecode.models.ShallowFBCSPNet" class="sphx-glr-backref-module-braindecode-models sphx-glr-backref-type-py-class"><span class="n">ShallowFBCSPNet</span></a><span class="p">(</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_chans</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_classes</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">input_window_samples</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">input_window_samples</span></a><span class="p">,</span>
    <span class="n">final_conv_length</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Send model to GPU</span>
<span class="k">if</span> <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cuda</span></a><span class="p">:</span>
    <a href="../generated/braindecode.models.ShallowFBCSPNet.html#braindecode.models.ShallowFBCSPNet" title="braindecode.models.ShallowFBCSPNet" class="sphx-glr-backref-module-braindecode-models sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">model</span></a><span class="o">.</span><a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cuda</span></a><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="training">
<h2>Training<a class="headerlink" href="#training" title="Permalink to this heading">¶</a></h2>
<p>Now we train the network! EEGClassifier is a Braindecode object
responsible for managing the training of neural networks. It inherits
from skorch.NeuralNetClassifier, so the training logic is the same as in
<a class="reference external" href="https://skorch.readthedocs.io/en/stable/">Skorch</a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">skorch.callbacks</span> <span class="kn">import</span> <span class="n">LRScheduler</span>

<span class="kn">from</span> <span class="nn">braindecode</span> <span class="kn">import</span> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.base.ClassifierMixin.html#sklearn.base.ClassifierMixin" title="sklearn.base.ClassifierMixin" class="sphx-glr-backref-module-sklearn-base sphx-glr-backref-type-py-class"><span class="n">EEGClassifier</span></a>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">batch_size</span></a> <span class="o">=</span> <span class="mi">16</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_epochs</span></a> <span class="o">=</span> <span class="mi">4</span>

<span class="n">clf</span> <span class="o">=</span> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.base.ClassifierMixin.html#sklearn.base.ClassifierMixin" title="sklearn.base.ClassifierMixin" class="sphx-glr-backref-module-sklearn-base sphx-glr-backref-type-py-class"><span class="n">EEGClassifier</span></a><span class="p">(</span>
    <a href="../generated/braindecode.models.ShallowFBCSPNet.html#braindecode.models.ShallowFBCSPNet" title="braindecode.models.ShallowFBCSPNet" class="sphx-glr-backref-module-braindecode-models sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">model</span></a><span class="p">,</span>
    <span class="n">criterion</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">NLLLoss</span><span class="p">,</span>
    <span class="n">optimizer</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">AdamW</span><span class="p">,</span>
    <span class="n">optimizer__lr</span><span class="o">=</span><span class="p">[],</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">batch_size</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">batch_size</span></a><span class="p">,</span>
    <span class="n">train_split</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># train /test split is handled by GridSearchCV</span>
    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;accuracy&quot;</span><span class="p">,</span>
        <span class="p">(</span><span class="s2">&quot;lr_scheduler&quot;</span><span class="p">,</span> <span class="n">LRScheduler</span><span class="p">(</span><span class="s1">&#39;CosineAnnealingLR&#39;</span><span class="p">,</span> <span class="n">T_max</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_epochs</span></a> <span class="o">-</span> <span class="mi">1</span><span class="p">)),</span>
    <span class="p">],</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">device</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">device</span></a><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Use scikit-learn GridSearchCV to tune hyperparameters. To be able
to do this, we slice the braindecode datasets that by default return
a 3-tuple to return X and y, respectively.</p>
<p><strong>Note</strong>: The KFold object splits the datasets based on their
length which corresponds to the number of compute windows. In
this (trialwise) example this is fine to do. In a cropped setting
this is not advisable since this might split compute windows
of a single trial into both train and valid set.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html#sklearn.model_selection.GridSearchCV" title="sklearn.model_selection.GridSearchCV" class="sphx-glr-backref-module-sklearn-model_selection sphx-glr-backref-type-py-class"><span class="n">GridSearchCV</span></a><span class="p">,</span> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.KFold.html#sklearn.model_selection.KFold" title="sklearn.model_selection.KFold" class="sphx-glr-backref-module-sklearn-model_selection sphx-glr-backref-type-py-class"><span class="n">KFold</span></a>
<span class="kn">from</span> <span class="nn">skorch.helper</span> <span class="kn">import</span> <a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="collections.abc.Sequence" class="sphx-glr-backref-module-collections-abc sphx-glr-backref-type-py-class"><span class="n">SliceDataset</span></a>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">array</span></a>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">train_X</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="collections.abc.Sequence" class="sphx-glr-backref-module-collections-abc sphx-glr-backref-type-py-class"><span class="n">SliceDataset</span></a><span class="p">(</span><a href="../generated/braindecode.datasets.BaseConcatDataset.html#braindecode.datasets.BaseConcatDataset" title="braindecode.datasets.BaseConcatDataset" class="sphx-glr-backref-module-braindecode-datasets sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">train_set</span></a><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">train_y</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">array</span></a><span class="p">([</span><span class="n">y</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="collections.abc.Sequence" class="sphx-glr-backref-module-collections-abc sphx-glr-backref-type-py-class"><span class="n">SliceDataset</span></a><span class="p">(</span><a href="../generated/braindecode.datasets.BaseConcatDataset.html#braindecode.datasets.BaseConcatDataset" title="braindecode.datasets.BaseConcatDataset" class="sphx-glr-backref-module-braindecode-datasets sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">train_set</span></a><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="mi">1</span><span class="p">)])</span>
<a href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.KFold.html#sklearn.model_selection.KFold" title="sklearn.model_selection.KFold" class="sphx-glr-backref-module-sklearn-model_selection sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cv</span></a> <span class="o">=</span> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.KFold.html#sklearn.model_selection.KFold" title="sklearn.model_selection.KFold" class="sphx-glr-backref-module-sklearn-model_selection sphx-glr-backref-type-py-class"><span class="n">KFold</span></a><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fit_params</span></a> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;epochs&#39;</span><span class="p">:</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_epochs</span></a><span class="p">}</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">param_grid</span></a> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;optimizer__lr&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.00625</span><span class="p">,</span> <span class="mf">0.000625</span><span class="p">,</span> <span class="mf">0.0000625</span><span class="p">],</span>
<span class="p">}</span>
<a href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html#sklearn.model_selection.GridSearchCV" title="sklearn.model_selection.GridSearchCV" class="sphx-glr-backref-module-sklearn-model_selection sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">search</span></a> <span class="o">=</span> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html#sklearn.model_selection.GridSearchCV" title="sklearn.model_selection.GridSearchCV" class="sphx-glr-backref-module-sklearn-model_selection sphx-glr-backref-type-py-class"><span class="n">GridSearchCV</span></a><span class="p">(</span>
    <span class="n">estimator</span><span class="o">=</span><span class="n">clf</span><span class="p">,</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">param_grid</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">param_grid</span></a><span class="p">,</span>
    <a href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.KFold.html#sklearn.model_selection.KFold" title="sklearn.model_selection.KFold" class="sphx-glr-backref-module-sklearn-model_selection sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cv</span></a><span class="o">=</span><a href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.KFold.html#sklearn.model_selection.KFold" title="sklearn.model_selection.KFold" class="sphx-glr-backref-module-sklearn-model_selection sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cv</span></a><span class="p">,</span>
    <span class="n">return_train_score</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span>
    <span class="n">refit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">error_score</span><span class="o">=</span><span class="s1">&#39;raise&#39;</span>
<span class="p">)</span>

<a href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html#sklearn.model_selection.GridSearchCV.fit" title="sklearn.model_selection.GridSearchCV.fit" class="sphx-glr-backref-module-sklearn-model_selection sphx-glr-backref-type-py-method"><span class="n">search</span><span class="o">.</span><span class="n">fit</span></a><span class="p">(</span><span class="n">train_X</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">train_y</span></a><span class="p">,</span> <span class="o">**</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fit_params</span></a><span class="p">)</span>

<span class="n">search_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">search</span><span class="o">.</span><span class="n">cv_results_</span></a><span class="p">)</span>

<span class="n">best_run</span> <span class="o">=</span> <span class="n">search_results</span><span class="p">[</span><span class="n">search_results</span><span class="p">[</span><span class="s1">&#39;rank_test_score&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Best hyperparameters were </span><span class="si">{</span><span class="n">best_run</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> which gave a validation &quot;</span>
      <span class="sa">f</span><span class="s2">&quot;accuracy of </span><span class="si">{</span><span class="n">best_run</span><span class="p">[</span><span class="s1">&#39;mean_test_score&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">% (training &quot;</span>
      <span class="sa">f</span><span class="s2">&quot;accuracy of </span><span class="si">{</span><span class="n">best_run</span><span class="p">[</span><span class="s1">&#39;mean_train_score&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%).&quot;</span><span class="p">)</span>

<span class="n">eval_X</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="collections.abc.Sequence" class="sphx-glr-backref-module-collections-abc sphx-glr-backref-type-py-class"><span class="n">SliceDataset</span></a><span class="p">(</span><a href="../generated/braindecode.datasets.BaseConcatDataset.html#braindecode.datasets.BaseConcatDataset" title="braindecode.datasets.BaseConcatDataset" class="sphx-glr-backref-module-braindecode-datasets sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">eval_set</span></a><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">eval_y</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="collections.abc.Sequence" class="sphx-glr-backref-module-collections-abc sphx-glr-backref-type-py-class"><span class="n">SliceDataset</span></a><span class="p">(</span><a href="../generated/braindecode.datasets.BaseConcatDataset.html#braindecode.datasets.BaseConcatDataset" title="braindecode.datasets.BaseConcatDataset" class="sphx-glr-backref-module-braindecode-datasets sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">eval_set</span></a><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">score</span></a> <span class="o">=</span> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html#sklearn.model_selection.GridSearchCV.score" title="sklearn.model_selection.GridSearchCV.score" class="sphx-glr-backref-module-sklearn-model_selection sphx-glr-backref-type-py-method"><span class="n">search</span><span class="o">.</span><span class="n">score</span></a><span class="p">(</span><span class="n">eval_X</span><span class="p">,</span> <span class="n">eval_y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Eval accuracy is </span><span class="si">{</span><a href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">score</span></a><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%.&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Fitting 2 folds for each of 3 candidates, totalling 6 fits
  epoch    train_accuracy    train_loss      lr     dur
-------  ----------------  ------------  ------  ------
      1            0.2569        2.0037  0.0063  2.2592
      2            0.5417        1.0258  0.0047  2.1893
      3            0.7014        0.6431  0.0016  2.1995
      4            0.8472        0.4717  0.0000  2.1984
  epoch    train_accuracy    train_loss      lr     dur
-------  ----------------  ------------  ------  ------
      1            0.2986        2.0675  0.0063  2.1939
      2            0.4167        1.2638  0.0047  2.1925
      3            0.6736        0.7800  0.0016  2.1997
      4            0.8056        0.6616  0.0000  2.1886
  epoch    train_accuracy    train_loss      lr     dur
-------  ----------------  ------------  ------  ------
      1            0.3056        1.6027  0.0006  2.1957
      2            0.2708        1.1093  0.0005  2.2460
      3            0.3681        0.9526  0.0002  2.1915
      4            0.5347        0.8761  0.0000  2.1893
  epoch    train_accuracy    train_loss      lr     dur
-------  ----------------  ------------  ------  ------
      1            0.3125        1.5974  0.0006  2.2048
      2            0.2917        1.0369  0.0005  2.1875
      3            0.3333        0.9243  0.0002  2.2072
      4            0.5694        0.8559  0.0000  2.1936
  epoch    train_accuracy    train_loss      lr     dur
-------  ----------------  ------------  ------  ------
      1            0.2361        1.7544  0.0001  2.2059
      2            0.2361        1.5565  0.0000  2.1928
      3            0.2708        1.5915  0.0000  2.1997
      4            0.3194        1.5404  0.0000  2.1919
  epoch    train_accuracy    train_loss      lr     dur
-------  ----------------  ------------  ------  ------
      1            0.2153        1.7057  0.0001  2.1911
      2            0.2847        1.5504  0.0000  2.1965
      3            0.2986        1.6305  0.0000  2.1935
      4            0.3125        1.6165  0.0000  2.3206
  epoch    train_accuracy    train_loss      lr     dur
-------  ----------------  ------------  ------  ------
      1            0.4861        2.2402  0.0063  4.3871
      2            0.5521        1.2775  0.0047  4.4525
      3            0.8299        0.8836  0.0016  4.3832
      4            0.8472        0.6766  0.0000  4.4009
Best hyperparameters were {&#39;optimizer__lr&#39;: 0.00625} which gave a validation accuracy of 39.24% (training accuracy of 82.64%).
Eval accuracy is 50.69%.
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 1 minutes  55.268 seconds)</p>
<p><strong>Estimated memory usage:</strong>  499 MB</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-plot-hyperparameter-tuning-with-scikit-learn-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/a7671a37e509d66f8a25812de650cb55/plot_hyperparameter_tuning_with_scikit-learn.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_hyperparameter_tuning_with_scikit-learn.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/d64670f59a0ee7e125ae228f318fb330/plot_hyperparameter_tuning_with_scikit-learn.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_hyperparameter_tuning_with_scikit-learn.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="plot_regression.html" class="btn btn-neutral float-left" title="Regression example on fake data" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="plot_tuh_eeg_corpus.html" class="btn btn-neutral float-right" title="Process a big data EEG resource (TUH EEG Corpus)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018-2021, Braindecode developers.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>